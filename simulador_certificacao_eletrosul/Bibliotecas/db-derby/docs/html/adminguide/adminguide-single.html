<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Derby Server and Administration Guide</title><META content="text/css" http-equiv="Content-Style-Type"><style type="text/css">
        a { color: black; border: none; text-decoration: none; }
        img { border: none; }
      </style></head><body topmargin="6" leftmargin="6" marginheight="6" marginwidth="6" bgcolor="white"><br><div valign="top"><div style="padding: 6pt; border-width: thin; border-color: black; font-family: Helvetica; margin-top: 2pc;"><div style="text-align: right; margin-bottom: 12pc; margin-top: 12pc; line-height: 100%; font-size: 12pt;"><img src="../images/logowithtext.jpg"></div></div><a name="cover"></a><div style="font-family: Helvetica; text-align: left;"><div style="line-height: 140%; font-weight: bold; font-size: 22pt;">Derby Server and Administration Guide</div><div style="font-style: italic; margin-bottom: 1in; line-height: 140%; font-size: 8pt;">
          Version 10.8</div></div><div style="line-height: normal; font-size: 8pt; text-align: right; margin-top: 3pc;">
          Derby Document build: <div>October 10, 2011, 3:03:56 PM (PDT)</div></div></div><br><br><div valign="top"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; text-align: center; color: purple;"></div></div><br><br><div valign="top"><div style="font-style: italic; margin-bottom: 1in; line-height: 140%; font-size: 8pt;">
          Version 10.8
         &nbsp;
	Derby Server and Administration Guide</div></div><div valign="top"><a name="page1-1"></a><div style="font-family: Helvetica; font-size: 10pt; line-height: 12pt;"><div style="font-family: Helvetica; text-align: left;"><div> &nbsp;&nbsp;&nbsp; </div><a name="contents"></a><div style="line-height: 140%; font-weight: bold; font-size: 20pt;">
              Contents </div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#radmincopyright"><span style="font-weight: bold;">Copyright</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#radminlicense"><span style="font-weight: bold;">License</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminpreface30074"><span style="font-weight: bold;">About this guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface11181"><span style="font-weight: bold;">Purpose of this guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface22460"><span style="font-weight: bold;">Audience</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface23947"><span style="font-weight: bold;">How this guide is organized</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminpartone"><span style="font-weight: bold;">Part one: Derby Server Guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminov11108"><span style="font-weight: bold;">Derby in a multi-user environment</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminov17524">Derby in a server framework &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminov38650">About this guide and the Network Server documentation &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminapps59125"><span style="font-weight: bold;">Using the Network Server with preexisting Derby applications</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsthenetworkserverandjvms">The Network Server and JVMs &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminappschangingyourclasspath">Installing required jar files and adding them to the classpath &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmincbdjhhfd">Starting the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigshuttingdownthenetworkserver">Shutting down the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigsysteminformation">Obtaining system information &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsclient">Accessing the Network Server by using the network client driver &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminnsdatasources">Accessing the Network Server by using a DataSource object &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminapps811478">XA and the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsusingthederbytoolswiththene">Using the Derby tools with the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminapps">Differences between running Derby in embedded mode and using the Network
Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminappssettingportnumbers">Setting port numbers &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminconfig86869"><span style="font-weight: bold;">Managing the Derby Network Server</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminconfigoverview">Overview &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigsettingnetwrokserverproperties">Setting Network Server properties &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigverifyingstartup">Verifying Startup &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminservlet98430"><span style="font-weight: bold;">Managing the Derby Network Server remotely by using the servlet interface</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810694">Start-up page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810717">Running page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810796">Trace session page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810822">Trace directory page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810910">Set Network Server parameters  &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminadvtops"><span style="font-weight: bold;">Derby Network Server advanced topics</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminnetservsecurity">Network Server security &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminnetservrun">Running the Network Server under the security manager &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminnetservusrauth">Running the Network Server with User Authentication &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminssl">Network encryption and authentication with SSL/TLS &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfiguringthenetworkserver">Configuring the Network Server to handle connections &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminlogfile">Controlling logging by using the log file &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmintracefacility">Controlling tracing by using the trace facility &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#radminsampleprograms"><span style="font-weight: bold;">Derby Network Server sample programs</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminovnssample">The NsSample sample program &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminovntsrvsample">Network Server sample programs for embedded and client connections &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminparttwo"><span style="font-weight: bold;">Part two: Derby Administration Guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminconsist01"><span style="font-weight: bold;">Checking database consistency</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist30301">The SYSCS_CHECK_TABLE function &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist38781">Sample SYSCS_CHECK_TABLE error messages &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist24642">Sample SYSCS_CHECK_TABLE queries &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminhubbkup98797"><span style="font-weight: bold;">Backing up and restoring databases</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminbckupdb">Backing up a database &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminhubbkup44">Restoring a database from a backup copy &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmincrtdbbkup">Creating a database from a backup copy &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminrollforward">Roll-forward recovery &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminimport16245"><span style="font-weight: bold;">Importing and exporting data</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimport98264">Methods for running the import and export procedures &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimport27052">Bulk import and export requirements and considerations &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimportlobs">Bulk import and export of large objects &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimportdefaultformat">File format for input and output &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminimporting">Importing data using the built-in procedures &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminexporting">Exporting data using the built-in procedures &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminimport91458">Examples of bulk import and export &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimportjdbc">Running import and export procedures from JDBC &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminimportnulls">How the import and export procedures process NULL values &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminimportcodeset">CODESET values for import and export procedures &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminreplication"><span style="font-weight: bold;">Replicating databases</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminreplicstartrun">Starting and running replication &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminreplicstop">Stopping replication &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminreplicfailover">Forcing a failover &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminreplicsecurity">Replication and security &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminreplicfailures">Replication failure handling &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminlog98"><span style="font-weight: bold;">Logging on a separate device</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminlog800206">Using the logDevice=logDirectoryPath attribute &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminlog800241">Example of creating a log in a non-default location &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminlog800279">Example of moving a log manually &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminlog800315">Issues for logging in a non-default location &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminlockvti42553"><span style="font-weight: bold;">Obtaining locking information</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminlockvti83889">Monitoring deadlocks &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminspace21579"><span style="font-weight: bold;">Reclaiming unused space</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#radmintrademderby"><span style="font-weight: bold;">Trademarks</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div></div></div></div><div valign="top"><div style="font-family: Helvetica; font-weight: bold; font-size: 10pt; text-align: center;"><span>&bull;</span></div></div><br><br><div valign="top"><div style="line-height: 8pt; font-size: 8pt;">Derby Server and Administration Guide</div></div><div valign="top"><div style="font-family: Helvetica; font-size: 10pt; text-align: left;">Apache Software FoundationDerby Server and Administration GuideApache Derby<div><a name="N1003D"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="radmincopyright"></a><div></div>Copyright</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10046"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><img src="../images/logowithtext.jpg"></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Copyright 2004-2011 The Apache Software Foundation</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> Licensed
under the Apache License, Version 2.0 (the "License"); you may not use this
file except in compliance with the License. You may obtain a copy of the License
at <span style="color: blue;"><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></span>.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1006C"></a><span></span><div style="font-weight: bold;">Related information</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#radminlicense">License</a></span></div></div></div></div><div><a name="N10094"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="radminlicense"></a><div></div>License</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;"></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N100B7"></a><span></span><div style="font-weight: bold;">The Apache License, Version 2.0</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
                               Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use,
      reproduction, and distribution as defined by Sections 1 through
      9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized
      by the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under
      common control with that entity. For the purposes of this
      definition, "control" means (i) the power, direct or indirect,
      to cause the direction or management of such entity, whether by
      contract or otherwise, or (ii) ownership of fifty percent (50%)
      or more of the outstanding shares, or (iii) beneficial ownership
      of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making
      modifications, including but not limited to software source code,
      documentation source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or
      Object form, that is based on (or derived from) the Work and
      for which the editorial revisions, annotations, elaborations,
      or other modifications represent, as a whole, an original work
      of authorship.  For the purposes of this License, Derivative
      Works shall not include works that remain separable from, or
      merely link (or bind by name) to the interfaces of, the Work
      and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or
      additions to that Work or Derivative Works thereof, that is
      intentionally submitted to Licensor for inclusion in the Work
      by the copyright owner or by an individual or Legal Entity
      authorized to submit on behalf of the copyright owner. For the
      purposes of this definition,
      "submitted" means any form of electronic, verbal, or written
      communication sent to the Licensor or its representatives,
      including but not limited to communication on electronic mailing
      lists, source code control systems, and issue tracking systems
      that are managed by, or on behalf of, the Licensor for the
      purpose of discussing and improving the Work, but excluding
      communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a
      Contribution."

      "Contributor" shall mean Licensor and any individual or Legal
      Entity on behalf of whom a Contribution has been received by
      Licensor and subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions
      of this License, each Contributor hereby grants to You a
      perpetual, worldwide, non-exclusive, no-charge, royalty-free,
      irrevocable copyright license to reproduce, prepare Derivative
      Works of, publicly display, publicly perform, sublicense, and
      distribute the Work and such Derivative Works in Source or
      Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have
      made, use, offer to sell, sell, import, and otherwise transfer
      the Work, where such license applies only to those patent claims
      licensable by such Contributor that are necessarily infringed by
      their Contribution(s) alone or by combination of their
      Contribution(s) with the Work to which such Contribution(s) was
      submitted. If You institute patent litigation against any entity
      (including a cross-claim or counterclaim in a lawsuit) alleging
      that the Work or a Contribution incorporated within the Work
      constitutes direct or contributory patent infringement, then any
      patent licenses granted to You under this License for that Work
      shall terminate as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute
          must include a readable copy of the attribution notices
          contained within such NOTICE file, excluding those notices
          that do not pertain to any part of the Derivative Works, in
          at least one of the following places: within a NOTICE text
          file distributed as part of the Derivative Works; within the
          Source form or documentation, if provided along with the
          Derivative Works; or, within a display generated by the
          Derivative Works, if and wherever such third-party notices
          normally appear. The contents of the NOTICE file are for
          informational purposes only and do not modify the License.
          You may add Your own attribution notices within Derivative
          Works that You distribute, alongside or as an addendum to
          the NOTICE text from the Work, provided that such additional
          attribution notices cannot be construed as modifying the
          License.

      You may add Your own copyright statement to Your modifications
      and may provide additional or different license terms and
      conditions for use, reproduction, or distribution of Your
      modifications, or for any such Derivative Works as a whole,
      provided Your use, reproduction, and distribution of the Work
      otherwise complies with the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state
      otherwise, any Contribution intentionally submitted for
      inclusion in the Work by You to the Licensor shall be under the
      terms and conditions of this License, without any additional
      terms or conditions.  Notwithstanding the above, nothing herein
      shall supersede or modify the terms of any separate license
      agreement you may have executed with Licensor regarding such
      Contributions.

   6. Trademarks. This License does not grant permission to use the
      trade names, trademarks, service marks, or product names of the
      Licensor, except as required for reasonable and customary use
      in describing the origin of the Work and reproducing the content
      of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or
      conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or
      FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for
      determining the appropriateness of using or redistributing the
      Work and assume any risks associated with Your exercise of
      permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and
      grossly negligent acts) or agreed to in writing, shall any
      Contributor be liable to You for damages, including any direct,
      indirect, special, incidental, or consequential damages of any
      character arising as a result of this License or out of the use
      or inability to use the Work (including but not limited to
      damages for loss of goodwill, work stoppage, computer failure or
      malfunction, or any and all other commercial damages or losses),
      even if such Contributor has been advised of the possibility of
      such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by
      reason of your accepting any such warranty or additional
      liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
   implied.  See the License for the specific language governing
   permissions and limitations under the License.
</div></pre></div></div></div><div><a name="N100D0"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminpreface30074"></a><div></div>About this guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes who this guide is for as well as how to use it.</div></div><div><a name="N10125"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface11181"></a><div></div>Purpose of this guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide explains how to use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a multiple-client environment.
It also provides information that a server administrator might need to keep
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> running with a high level of performance and reliability in a server framework
or in a multiple-client application server environment (When running in embedded mode, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
databases typically do not need any administration).</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To connect multiple clients with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server
framework that you choose, or you can use the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server. This
guide describes these options.</div></div></div><div><a name="N1019A"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface22460"></a><div></div>Audience</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The first part of this guide is intended for developers of client/server
and multiple-client applications. The second part of this guide is intended for administrators.</div></div></div><div><a name="N101E6"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface23947"></a><div></div>How this guide is organized</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide includes the following two parts:</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Part one: <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Server Guide</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminov11108">Derby in a multi-user environment</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes the different options for embedding <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server framework and
explains the Network Server option.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to change existing <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> applications to work with the
Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to use shell scripts, the command
line, and the Network Server API to manage the Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to use the servlet interface to manage the Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminadvtops">Derby Network Server advanced topics</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes
advanced topics for <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server users.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#radminsampleprograms">Derby Network Server sample programs</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes several <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
Network Server sample programs for Network Server users.</div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Part two: <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Administration Guide</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminconsist01">Checking database consistency</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to check the consistency of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminhubbkup98797">Backing up and restoring databases</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to back up a database when it is online.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminimport16245">Importing and exporting data</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to import and export large amounts of data between files and
database tables.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminreplication">Replicating databases</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to replicate databases.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to put a database's log on a separate device, which can improve the performance of large databases.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminlockvti42553">Obtaining locking information</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to get detailed information about locking status.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminspace21579">Reclaiming unused space</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to identify and reclaim unused space in tables and related indexes.</div></div></td></tr></table></div></div></div></div><div><a name="N10372"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminpartone"></a><div></div>Part one: Derby Server Guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This part of the guide explains the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server and other server frameworks.
</div></div><div><a name="N103F2"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminov11108"></a><div></div>Derby in a multi-user environment</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes how to use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a multi-user (or "server") environment.</div></div><div><a name="N1048E"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminov17524"></a><div></div>Derby in a server framework</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In a sense, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is
always an embedded product. You can embed it in an application in which users
access the database from a single JVM or you can embed it in a server framework
(an application that allows users from different JVMs to connect to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> simultaneously).
When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded
in an application, the local JDBC driver calls the local <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database.
When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded
in a server framework, the server framework's connectivity software provides
data to multiple client JDBC applications over a network or the Internet.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For local or remote multi-user connectivity (multiple users who access <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> from different JVMs),
use the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server. If you require features that are not included in the Network Server,
you can embed the basic <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> product
in another server framework.</div></div><div><a name="N1055A"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825125"></a><div></div>Connectivity configurations</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are several ways to embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
a server framework:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Use the Network Server</span></div><div style="margin-left: 72pt + 16pt;">This is the easiest way to provide connectivity to multiple users who
are accessing <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
from different JVMs. The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server provides this kind of connectivity to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
within a single system or over a network.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Purchase another server framework</span></div><div style="margin-left: 72pt + 16pt;">You can use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> within
many server frameworks, such as IBM WebSphere Application Server.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Write your own framework</span></div><div style="margin-left: 72pt + 16pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s flexibility
allows other configurations as well. For example, rather than embedding <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server that communicates
with a client that uses JDBC, you can embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> within
a servlet in a web server that communicates with a browser using HTTP.</div></div></div></div></div><div><a name="N1062D"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov33597"></a><div></div>Multiple-client features available in Derby</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> contains some features that are useful for developing multi-user applications.</div></div><div><a name="N106E5"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov28261"></a><div></div>Row-level locking: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To support multi-user access, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> utilizes
row-level locking. However, you can configure <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> to
use table-level locking in environments that have few concurrent transactions
(for example, a read-only database) . Table-level locking is preferable if
there are few or no writes to the server, while row-level locking is essential
for good performance if many clients write to the server concurrently. The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> optimizer tunes lock
choice for queries automatically.</div></div></div><div><a name="N10777"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov16172"></a><div></div>Multiple concurrency levels: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> supports SERIALIZABLE
(RR), REPEATABLE (RS), READ COMMITTED (CS), and READ UNCOMMITTED (UR) isolation
levels.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CS</span></div><div style="margin-left: 72pt + 16pt;">CS (the default isolation level) provides the best balance between concurrency
and consistency in multiple-client environments.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">RS</span></div><div style="margin-left: 72pt + 16pt;">RS provides less consistency than RR but allows more concurrency.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">RR</span></div><div style="margin-left: 72pt + 16pt;">RR provides greatest consistency.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">UR</span></div><div style="margin-left: 72pt + 16pt;">UR provides maximum concurrency, if uncommitted values are allowed in
the query. It is typically used if approximate results are acceptable.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See "Types and Scope of Locks in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Systems"
in the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information.</div></div></div><div><a name="N10838"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov65220"></a><div></div>Multi-connection and multi-threading: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> allows multiple simultaneous connections to a database, even
in embedded mode. <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is also fully multi-threaded, and you can have
multiple threads active at the same time. However, JDBC semantics impose some
limitations on multi-threading. See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for more information.</div></div></div><div><a name="N108C7"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov83312"></a><div></div>Administrative tools: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides some tools
and features to assist database administrators, including:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Consistency checker</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Online backup</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Procedures for importing and exporting data</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Database replication</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The ability to put a database's log on a separate device</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Locking information monitoring</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Reclaiming unused space</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">These tools and features are discussed in Part Two of this guide. See the
sections in that part for more information.</div></div></div></div><div><a name="N10952"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825266"></a><div></div>The Derby Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server provides multi-user connectivity to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
within a single system or over a network. The Network Server uses the standard
Distributed Relational Database Architecture (DRDA) protocol to receive and
reply to queries from clients. Databases are accessed through the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server by using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client driver.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The Network Server is a solution for multiple JVMs that connect to the
database, unlike the embedded scenario where only one JVM runs as part of
the system. When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is
embedded in a single-JVM application, the embedded JDBC driver calls the local <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database. When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded in a server
framework, the server framework's connectivity software provides data to multiple
client JDBC applications over a network or the Internet.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">To run the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, you need to install the following files:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the server side, install <span style="font-family: Courier;">derby.jar</span> and <span style="font-family: Courier;">derbynet.jar</span>.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the client side, install <span style="font-family: Courier;">derbyclient.jar</span>.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are several ways to manage the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, including:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Through the command line</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>By using .bat and .ksh scripts</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Through the servlet interface</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>With your own Java program (written using the Network Server API)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>By setting Network Server properties</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span> explains how
to change existing Java applications that currently run against <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode to run against the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span> explains
how to manage the Network Server by using the command line, including starting
and stopping it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> explains
how to use the servlet interface to manage the Network Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminadvtops">Derby Network Server advanced topics</a></span> contains advanced
topics for <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server users.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Because of the differences in JDBC drivers that are used, you might encounter
differences in functionality when running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
the Network Server framework as opposed to running it embedded in a user application.
Refer to <span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span> for a complete
list of the differences between embedded and Network Server configurations.</div></div></div><div><a name="N10A9F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825149"></a><div></div>Embedded servers</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Because <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is written in Java, you have great flexibility in how you choose to configure your deployment. For example, you can run <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, the JDBC server framework, and another application in the same JVM as a single process.</div></div></div><div><a name="N10B21"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminembeddedserver"></a><div></div>How to start an embedded server from an application</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In one thread, the embedding application starts the local JDBC driver for
its own access.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">/*
    If you are running on JDK 6 or higher, you do not
    need to invoke Class.forName(). In that environment, the
    EmbeddedDriver loads automatically.
*/
Class.forName("org.apache.derby.jdbc.EmbeddedDriver");
Connection conn = DriverManager.getConnection(
    "jdbc:derby:sample");
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In another thread, the same application starts the server framework to allow
remote access. Starting the server framework from within the application allows
both the server and the application to run in the same JVM.</div></div></div><div><a name="N10BA2"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminembeddedserverex"></a><div></div>Embedded server example</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10BBC"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can start the Network Server in another thread automatically
when <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> starts by setting
the <span style="font-style: italic;">derby.drda.startNetworkServer</span> property (see <span style="color: blue;"><a href="#tadminconfigsettingnetwrokserverproperties">Setting Network Server properties</a></span>), or you can start it by using a program. The following example shows how to start the Network Server by using a program:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10BD9"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">import org.apache.derby.drda.NetworkServerControl;
import java.net.InetAddress;
NetworkServerControl server = new NetworkServerControl
	(InetAddress.getByName("localhost"),1527);
server.start(null);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10BE3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The program that starts the Network Server can access the database
by using either the embedded driver or the Network Client driver.
The server framework's attempt to boot the local JDBC driver is ignored because
it has already been booted within the application's JVM. The server framework
simply accesses the instance of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> that is already booted. There is no conflict between the application and the server framework.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10BF2"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The remote client can then connect through the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> client
driver:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10C01"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String nsURL="jdbc:derby://localhost:1527/sample";  
java.util.Properties props = new java.util.Properties();
props.setProperty("user","usr");
props.setProperty("password","pwd");

/*
    If you are running on JDK 6 or higher, you do not
    need to invoke Class.forName(). In that environment, the
    ClientDriver loads automatically.
*/
Class.forName("org.apache.derby.jdbc.ClientDriver");
Connection conn = DriverManager.getConnection(nsURL, props);

/*interact with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>*/
Statement s = conn.createStatement();

ResultSet rs = s.executeQuery(
"SELECT * FROM HotelBookings");</div></pre></div></div></div></div></div><div><a name="N10C79"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminov38650"></a><div></div>About this guide and the Network Server documentation</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide assumes that you are familiar with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> features and tuning. Before reading this guide, you should first learn about basic <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> functionality
by reading the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span>. Also, because multi-user environments typically
have performance and tuning issues, you should read <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Tuning Derby</span></span></span>.</div></div></div></div><div><a name="N10CDF"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminapps59125"></a><div></div>Using the Network Server with preexisting Derby applications</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You must modify Java applications that currently run against <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode so that they work with the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server. The topics in this section discuss these changes.</div></div><div><a name="N10DFB"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsthenetworkserverandjvms"></a><div></div>The Network Server and JVMs</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server
is compatible with Java Platform, Standard Edition, v 1.4.2
(J2SE) and above.</div></div></div><div><a name="N10EB9"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminappschangingyourclasspath"></a><div></div>Installing required jar files and adding them to the classpath</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10EE2"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the Network Server and network client driver, add the
following jar file to your server classpath:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">derbyrun.jar</span></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Adding this file to your classpath has the effect of including all of the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> classes in your 
classpath. These classes are in the following jar files, which you can also add
to your classpath separately:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-family: Courier;">derbynet.jar</span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This jar file contains the Network Server
code. It must be in your classpath to start the Network Server.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-family: Courier;">derby.jar</span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This jar file contains the 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database engine code.
It must be in the classpath in order for the Network Server to access 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases. 
<span style="font-family: Courier;">derby.jar</span> is included in the Class-Path attribute of
<span style="font-family: Courier;">derbynet.jar</span>'s manifest file. If you have <span style="font-family: Courier;">derbynet.jar</span>
in the classpath and <span style="font-family: Courier;">derby.jar</span> is in the same directory as 
<span style="font-family: Courier;">derbynet.jar</span>, it is not necessary to include <span style="font-family: Courier;">derby.jar</span>
explicitly.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-family: Courier;">derbyclient.jar</span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This jar file contains
the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Client 
JDBC driver that is necessary for communication with the Network Server. It must
be in the classpath of the application on the client side in order to access 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases over a network.
</div></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10F85"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">All of the jar files are in the 
<span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib</span>
directory.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
script files for setting the classpath to work with the Network Server. The
scripts are located in the <span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span>
directory.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">setNetworkClientCP.bat</span> (Windows)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">setNetworkClientCP</span> (UNIX)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">setNetworkServerCP.bat</span> (Windows)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">setNetworkServerCP</span> (UNIX)</div></td></tr></table></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10FDC"></a><span></span>See <span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span> and <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Getting Started with Derby</span></span></span> for more information
on setting the classpath.</div></div></div><div><a name="N1109D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmincbdjhhfd"></a><div></div>Starting the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To start the Network Server, you can invoke a script, a jar file, or 
a class.
</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N110CB"></a><span></span><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">&gt;
        Important: </span>  Note that you should always properly shut down the Network Server
after use, because failure to do so might result in unpredictable side-effects,
such as blocked ports on the server.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N110D5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
You are strongly urged to enable user authentication and user authorization when
you run a Network Server. For details on how to configure user authentication,
see "Working with user authentication" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>. For information on user
authorization, see "Users and authorization identifiers" and "User
authorizations" in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>.
You are also urged to install a Java security manager with a
customized security policy. For details on how to do this, see
<span style="color: blue;"><a href="#tadminnetservcustom">Customizing the Network Server's security policy</a></span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can start the Network Server in any of the following ways:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are relatively new to the Java programming language, follow the 
instructions in "Setting up your environment" in
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Getting Started with Derby</span></span> to set the 
<span style="font-family: Courier;"><span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span></span> 
and <span style="font-family: Courier;">JAVA_HOME</span> environment variables and to add
<span style="font-family: Courier;"><span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span>
to your path. Then use the <span style="font-family: Courier;">startNetworkServer.bat</span>
script to start the Network Server on Windows machines and the <span style="font-family: Courier;">startNetworkServer</span>
script to start the Network Server on UNIX systems. These scripts are located
in <span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span>,
where <span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span></span> is the
directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You
can run NetworkServerControl commands only from the host that started the
Network Server. The following table shows the sequence of commands.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 1. </span>Commands to run the <span style="font-family: Courier;">startNetworkServer</span> command</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Operating System</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Command</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Windows</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">set DERBY_HOME=C:\derby</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">set JAVA_HOME=C:\Program Files\Java\jdk1.6.0_24</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">set PATH=%DERBY_HOME%\bin;%PATH%</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">startNetworkServer</span></span></div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>UNIX (Korn Shell)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">export DERBY_HOME=/opt/derby</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">export JAVA_HOME=/usr/j2se</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">export PATH="$DERBY_HOME/bin:$PATH"</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">startNetworkServer</span></span>
</div></pre></div></td></tr></tbody></table></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are a regular Java user but are new to
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, set the 
<span style="font-family: Courier;"><span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span></span>
environment variable, then use a <span style="font-family: Courier;">java</span> command to invoke the 
<span style="font-family: Courier;">derbyrun.jar</span> or <span style="font-family: Courier;">derbynet.jar</span> file, as shown
in the following table.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 2. </span>Commands to invoke the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> jar files</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Operating System</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Command</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Windows</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">set DERBY_HOME=C:\derby</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">java -jar %DERBY_HOME%\lib\derbyrun.jar server start</span></span>
or
<span style="font-weight: bold;"><span style="font-family: Courier;">java -jar %DERBY_HOME%\lib\derbynet.jar start</span></span></div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>UNIX (Korn Shell)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">export DERBY_HOME=/opt/derby</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">java -jar $DERBY_HOME/lib/derbyrun.jar server start</span></span>
or
<span style="font-weight: bold;"><span style="font-family: Courier;">java -jar $DERBY_HOME/lib/derbynet.jar start</span></span></div></pre></div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To see the command syntax, invoke <span style="font-family: Courier;">derbyrun.jar server</span> or
<span style="font-family: Courier;">derbynet.jar</span> with no arguments.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are familiar with both the Java programming language and Derby, 
you have already set 
<span style="font-family: Courier;"><span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span></span>. 
Set your classpath to include the 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
jar files. Then use a <span style="font-family: Courier;">java</span> command to invoke the 
<span style="font-family: Courier;">NetworkServerControl</span> class directly, as shown in the following
table.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 3. </span>Commands to invoke the <span style="font-family: Courier;">NetworkServerControl</span> class</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Operating System</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Command</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Windows</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">%DERBY_HOME%\bin\setNetworkServerCP</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">java org.apache.derby.drda.NetworkServerControl start</span></span></div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>UNIX (Korn Shell)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">$DERBY_HOME/bin/setNetworkServerCP</span></span>
<span style="font-weight: bold;"><span style="font-family: Courier;">java org.apache.derby.drda.NetworkServerControl start</span></span></div></pre></div></td></tr></tbody></table></div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The default system directory is the directory in which 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> was started. (See 
the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information about the default system directory.)</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can specify a different host or port number when you start the Network
Server by specifying an option to the command.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Specify a port number other than the default (1527) by using the 
<span style="font-family: Courier;">-p <span style="font-style: italic;">portnumber</span></span> option, as shown in the 
following example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">java org.apache.derby.drda.NetworkServerControl start -p 1368</span></span>
</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Specify a specific interface (host name or IP address) to listen on other 
than the default (<span style="font-family: Courier;">localhost</span>) by using the <span style="font-family: Courier;">-h</span> 
option, as shown in the following example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">$DERBY_HOME/bin/startNetworkServer -h myhost -p 1368</span></span>
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">where <span style="font-style: italic;">myhost</span> is the host name or IP address.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Remember: </span>  Before using the <span style="font-family: Courier;">-h</span> option, you should 
run under the Java security manager with a customized security policy
and you should enable user authentication.</div></div></td></tr></table></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1141E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the Network Server will listen to requests only on
the loopback address, which means that it will only accept connections from
the local host.</div></div></div><div><a name="N114EF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig814963"></a><div></div>Starting the Network Server from a Java application</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1150E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that you should always properly shut down the Network Server
after use, because failure to do so might result in unpredictable side-effects,
such as blocked ports on the server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are two ways to start the
Network Server from a Java application.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can include the following line in the <span style="font-family: Courier;">derby.properties</span> file: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.startNetworkServer=true</div></pre>This starts
the server on the default port, 1527, listening on <span style="font-family: Courier;">localhost</span> (all
interfaces).</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To specify a different port or a specific
interface in the <span style="font-family: Courier;">derby.properties</span> file, include the following
lines, respectively:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.portNumber=1110
derby.drda.host=<span style="font-style: italic;">myhost</span></div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also specify
the <span style="font-family: Courier;">startNetworkServer</span> and <span style="font-family: Courier;">portNumber</span> properties
by using a Java command: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Dderby.drda.startNetworkServer=true
-Dderby.drda.portNumber=1110
-Dderby.drda.host=<span style="font-style: italic;">myhost yourApp</span></div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl API to start the Network Server
from a separate thread within a Java application:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl server = new NetworkServerControl();
server.start (null);</div></pre></div></div></td></tr></table></div></div></div><div><a name="N115B4"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfigipx"></a><div></div>Starting the Network Server on IPv6/IPv4 dual stack Windows machines</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N115D3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following JVM properties need to be added to the command
when starting the server on IPv6/IPv4 dual stack Windows machines:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">-Djava.net.preferIPv4Stack=false
-Djava.net.preferIPv6Addresses=true</div></pre></div></div></div></div><div><a name="N1160D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigshuttingdownthenetworkserver"></a><div></div>Shutting down the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To shut down a Network Server, you can invoke a script, a jar
file, or a class.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1163B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The scripts to shut down a Network Server are located in the
<span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span>
directory.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">&gt;
        Important: </span>  If user authentication is enabled, you must specify a
valid <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> user name
and password; if the user authentication check fails, you'll see an
authentication error and the running server remains intact. Note that <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does not yet restrict
the shutdown privilege to specific users: the server can be shut down by
any user on the server machine who presents valid credentials.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by using the scripts provided
for Windows systems, use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">stopNetworkServer.bat [-h <span style="font-style: italic;">hostname</span>] [-p <span style="font-style: italic;">portnumber</span>] [-user <span style="font-style: italic;">username</span>] [-password <span style="font-style: italic;">password</span>]</span></span>
</div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by using the scripts provided
for UNIX systems, use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">stopNetworkServer [-h <span style="font-style: italic;">hostname</span>] [-p <span style="font-style: italic;">portnumber</span>] [-user <span style="font-style: italic;">username</span>] [-password <span style="font-style: italic;">password</span>]</span></span>
</div></pre></div></div></td></tr></table></div></div><div><a name="N11796"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815333"></a><div></div>Shutting down by using the command line</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N117B5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">From the command line, you can shut down a Network Server by invoking a
jar file or a class. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that you need to provide user credential arguments to shut down a server running with user authentication.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by invoking a jar file from the
<span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib</span>
directory, use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -jar derbyrun.jar server shutdown [-h <span style="font-style: italic;">&lt;hostname&gt;</span>] [-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] [-user <span style="font-style: italic;">&lt;username&gt;</span>] [-password <span style="font-style: italic;">&lt;password&gt;</span>]
</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">or
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -jar derbynet.jar shutdown [-h <span style="font-style: italic;">&lt;hostname&gt;</span>] [-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] [-user <span style="font-style: italic;">&lt;username&gt;</span>] [-password <span style="font-style: italic;">&lt;password&gt;</span>]
</div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by invoking a class,
use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl shutdown [-h <span style="font-style: italic;">&lt;hostname&gt;</span>] [-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] [-user <span style="font-style: italic;">&lt;username&gt;</span>] [-password <span style="font-style: italic;">&lt;password&gt;</span>]
</div></pre></div></div></td></tr></table></div></div></div><div><a name="N11877"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815357"></a><div></div>Shutting down by using the API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11896"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the NetworkServerControl API to shut down the Network
Server from within a Java application. The name of the method that you use
to shutdown the Network Server is <span style="font-family: Courier;">shutdown()</span>.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N118A5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, the following command shuts down the Network Server
running on the current machine using the default port number (1527):</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
NetworkServerControl server = new NetworkServerControl();
server.shutdown();
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To shut down a server running with user authentication, you need to use
a NetworkServerControl instance created with user credentials:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
NetworkServerControl server = new NetworkServerControl(username, password);
server.shutdown();
</div></pre></div></div></div></div><div><a name="N118EA"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigsysteminformation"></a><div></div>Obtaining system information</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N118F3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can obtain information about the Network Server, such as
version and current property values, Java information, and <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database
server information, by using the <span style="font-family: Courier;">sysinfo</span> utility. The <span style="font-family: Courier;">sysinfo</span> utility
is available from scripts, the command line, the NetworkServerControl API,
and through the servlet interface.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following scripts are located
in the <span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span>
directory. Before running these scripts, make sure that the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server is started.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the following script to obtain information about
the Network Server on a Windows system:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">NetworkServerControl.bat sysinfo [-h <span style="font-style: italic;">hostname</span>][-p <span style="font-style: italic;">portnumber</span>]</span></span></div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the following script to obtain information about
the Network Server on a UNIX system:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">NetworkServerControl sysinfo [-h <span style="font-style: italic;">hostname</span>] [-p <span style="font-style: italic;">portnumber</span>]</span></span></div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11977"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information on the <span style="font-family: Courier;">sysinfo</span> utility, see
the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Tools and Utilities Guide</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also use Java Management Extensions (JMX) technology to obtain
system information. For details, visit the wiki page
<span style="color: blue;"><a href="http://wiki.apache.org/db-derby/DerbyJMX">http://wiki.apache.org/db-derby/DerbyJMX</a></span> and refer to
the API documentation for the packages <span style="font-family: Courier;">org.apache.derby.mbeans</span>
and <span style="font-family: Courier;">org.apache.derby.mbeans.drda</span>. For information on JMX
technology, see
<span style="color: blue;"><a href="http://download.oracle.com/javase/6/docs/technotes/guides/jmx/">http://download.oracle.com/javase/6/docs/technotes/guides/jmx/</a></span>.
</div></div></div><div><a name="N11A7A"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815768"></a><div></div>Obtaining system information by using the command line</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11A83"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run <span style="font-family: Courier;">sysinfo</span> from the command line, use 
a command like one of the following while the Network Server is running:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java -jar $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib/derbyrun.jar server sysinfo
  [-h <span style="font-style: italic;">hostname</span>][-p <span style="font-style: italic;">portnumber</span>]</span></div></pre><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl sysinfo 
  [-h <span style="font-style: italic;">hostname</span>][-p <span style="font-style: italic;">portnumber</span>]</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Administrative
commands such as <span style="font-family: Courier;">sysinfo</span> can
only  execute on the host where the server was started, even if the server
was started with the <span style="font-family: Courier;">-h</span> option.</div></div></div></div><div><a name="N11B01"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815853"></a><div></div>Obtaining system information by using the API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11B2A"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">sysinfo</span> method produces the same information
as the <span>sysinfo</span> command. The signature for this method is</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String getSysinfo();</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11B45"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl serverControl = new NetworkServerControl();
String myinfo = serverControl.getSysinfo();</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">getSysinfo()</span> method
returns information about the Network Server that is running on the current
machine on the default port number (1527).</div></div></div><div><a name="N11BAC"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="tadminappsruntimeinfo"></a><div></div>Obtaining Network Server runtime information: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11BB5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the <span style="font-weight: bold;">runtimeinfo</span> command or <span style="font-weight: bold;">getRuntimeInfo</span> method
to get memory usage and current session information about the Network Server
including user, database, and prepared statement information.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To run <span style="font-weight: bold;">runtimeinfo</span> from the command line:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl runtimeinfo 
   [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][&lt;-p <span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">The <span style="font-weight: bold;">getRuntimeInfo</span> method returns the same information as
the <span style="font-weight: bold;">runtimeinfo</span> command. The signature for the getRuntimeInfo method
is String getRuntimeInfo(). For example:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl serverControl = new NetworkServerControl();
String <span style="font-style: italic;">myinfo</span> = serverControl.getRuntimeInfo(); </div></pre></div></div></td></tr></table></div></div></div><div><a name="N11C44"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815822"></a><div></div>Obtaining Network Server properties by using the getCurrent Properties
method: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11C63"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The getCurrentProperties method is a Java method that you can
use to obtain information about the Network Server. It returns a Properties
object with the value of all the Network Server properties as they are currently
set.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The signature of this method is:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Properties getCurrentProperties();</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11C77"></a><span></span>For example:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl server = new NetworkServerControl();
Properties p = server.getCurrentProperties();
p.list(System.out);
System.out.println(p.getProperty("derby.drda.host"));</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">As shown
in the previous example, you can look up the current properties and then work
with individual properties if needed by using various APIs on the Properties
class. You can also print out all the properties by using the Properties.list()
method.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11C87"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about obtaining system information using the servlet interface.</div></div></div></div></div></div><div><a name="N11CC4"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsclient"></a><div></div>Accessing the Network Server by using the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">When connecting to the Network Server, your application needs to
load a driver and connection URL that is specific to the Network Server. In
addition, you must specify a user name and password if you are using authentication.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The driver that you need to access the Network Server is: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">org.apache.derby.jdbc.ClientDriver</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The syntax of the URL that is required to access the Network Server is:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://&lt;<span style="font-style: italic;">server</span>&gt;[:&lt;<span style="font-style: italic;">port</span>&gt;]/
&lt;<span style="font-style: italic;">databaseName</span>&gt;[;&lt;URL attribute&gt;=&lt;value&gt; [;...]]
</div></pre>where the <span style="font-family: Courier;">&lt;URL attribute&gt;</span> is either a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded or network
client attribute.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To access an in-memory database using the Network Server, the syntax is:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://&lt;<span style="font-style: italic;">server</span>&gt;[:&lt;<span style="font-style: italic;">port</span>&gt;]/memory:
&lt;<span style="font-style: italic;">databaseName</span>&gt;[;&lt;URL attribute&gt;=&lt;value&gt; [;...]]
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "Using in-memory databases" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For both driver and DataSource access, the database name (including path), 
user, password  and other attribute values must consist of
characters that can be converted to UTF-8.  The total byte length of the 
database name plus attributes when converted to UTF-8 must not exceed 255 
bytes; keep in mind that in UTF-8, a character may occupy from 1 to 4 bytes.
You may be able to work around this restriction for long paths or 
paths that include multibyte characters by setting the 
<span style="font-family: Courier;">derby.system.home</span> system property when starting the Network 
Server and accessing the database with a relative path that is shorter and 
does not include multibyte characters.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table shows standard JDBC DataSource properties.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 4. </span>Standard JDBC DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL Attribute</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>databaseName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The name of the database. This property is required.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>dataSourceName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The data source name.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>A description of the data source.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>user</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The user's account name.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">user</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is APP. This property is also available using
EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The user's database password.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">password</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>serverName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The host name or TCP/IP address where the server is
listening for requests.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is "localhost".</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>portNumber</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The port number where the server is listening for requests.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is "1527".</div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table shows client-specific JDBC DataSource properties.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 5. </span>Client-specific DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL Attribute</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceFile</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The filename for tracing output. Setting this property
turns on tracing. See <span style="color: blue;"><a href="#cadminappsclienttracing">Network client tracing</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceFile</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceDirectory</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The directory for the tracing output. Each connection
will send output to a separate file. Setting this property turns on tracing.
See <span style="color: blue;"><a href="#cadminappsclienttracing">Network client tracing</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceDirectory</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>None</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceLevel</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The level of client tracing if <span style="font-style: italic;">traceFile</span> or <span style="font-style: italic;">traceDirectory</span> are
set.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceLevel</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is TRACE_ALL.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceFileAppend</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Boolean</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Value is true if tracing output should append to the
existing trace file.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceFileAppend</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is false.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>securityMechanism</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The security mechanism. See <span style="color: blue;"><a href="#cadminappsclientsecurity">Network client security</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">securityMechanism</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is USER_ONLY _SECURITY.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>retrieveMessageText</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Boolean</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Retrieve message text from the server. A stored procedure
is called to retrieve the message text with each <span style="font-style: italic;">SQLException</span> and might
start a new unit of work. Set this property to false if you do not want the
performance impact or when starting new units of work.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">retrieveMessageText</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is true.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ssl</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The SSL mode for the client connection. See <span style="color: blue;"><a href="#cadminssl">Network encryption and authentication with SSL/TLS</a></span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">ssl</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is <span style="font-family: Courier;">off</span>.</div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table shows server-specific JDBC DataSource properties.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 6. </span>Server-specific DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL Attribute</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>connectionAttributes</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Set to the list of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
connection attributes separated by semicolons.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Various</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.
See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for more information
about the various connection attributes.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>createDatabase</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>If set to "create", create the database specified with databaseName property.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">create</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.
See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for more information.
Similar to setting connectionAttribute to "create=true". Only "create" is allowed, other values equate to null. The result of conflicting settings of createDatabase, shutdownDatabase and connectionAttributes is undefined.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>shutdownDatabase</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>If set to "shutdown", shutdown the database specified with databaseName property.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">shutdown</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.
See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for more information.
Similar to setting connectionAttribute to "shutdown=true". Only "shutdown" is allowed, other values equate to null. The result of conflicting settings of createDatabase, shutdownDatabase and connectionAttributes is undefined.
If authentication <span style="font-weight: bold;">and</span> sqlAuthorization are both enabled, database shutdown is restricted to the database owner.
</div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that <span style="font-style: italic;">setAttributesAsPassword</span>, which is available for the embedded
DataSource, is not available for the client DataSource.</div></div><div><a name="N12226"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclientsecurity"></a><div></div>Network client security</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client allows you to select a security mechanism by specifying a value for
the <span style="font-family: Courier;">securityMechanism</span> property.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can set the <span style="font-family: Courier;">securityMechanism</span> property in one of the
following ways:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When you are using the <span style="font-family: Courier;">DriverManager</span> interface, set <span style="font-family: Courier;">securityMechanism</span> in
a <span style="font-family: Courier;">java.util.Properties</span> object before you invoke the form
of the <span style="font-family: Courier;">getConnection</span> method, which includes the <span style="font-family: Courier;">java.util.Properties</span> parameter.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When you are using the <span style="font-family: Courier;">DataSource</span> interface to create
and deploy your own DataSource objects, invoke the <span style="font-family: Courier;">DataSource.setSecurityMechanism</span> method
after you create a DataSource object.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table lists the security mechanisms that the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client supports, and the corresponding property value to specify to obtain
this security mechanism. The default security mechanism is the user id only
if no password is set. If the password is set, the default security mechanism
is both the user id and password. The default user is APP if no other user
is specified.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 7. </span>Security mechanisms supported by the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Client</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Security Mechanism</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>securityMechanism Property Value</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Comments</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>User id and password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.CLEAR_TEXT_PASSWORD_SECURITY
(0x03)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default if password is set</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>User id only</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.USER_ONLY_SECURITY (0x04)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default if password is not set</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Strong password substitution</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.STRONG_PASSWORD_SUBSTITUTE_SECURITY
(0x08)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Strong password substitution can be used only with
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s BUILTIN
authentication mechanism or with authentication disabled. Also, for the BUILTIN
mechanism, strong password substitution does not work for database-level users
whose password has been protected by a custom message digest algorithm specified
by the <span style="font-style: italic;">derby.authentication.builtin.algorithm</span> property.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Encrypted user id and encrypted password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.ENCRYPTED_USER_AND_PASSWORD_SECURITY
(0x09)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Encryption requires a JCE implementation that supports
the Diffie-Hellman algorithm with a public prime of 256 bits.</div></td></tr></tbody></table></div></div></div><div><a name="N12385"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclienttracing"></a><div></div>Network client tracing</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
client provides a tracing facility to collect JDBC trace information and view
protocol flows.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N123AA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">There are various ways to obtain trace output. However, the easiest
way to obtain trace output is to use the <span style="font-family: Courier;">traceFile=<span style="font-style: italic;">path</span></span> attribute
on the URL in <span style="font-family: Courier;">ij</span>. The following example shows all tracing
going to the file <span style="font-family: Courier;">trace.out</span> from an <span style="font-family: Courier;">ij</span> session.<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt;connect 'jdbc:derby://localhost:1527/mydb;
create=true;traceFile=trace.out;user=user1;password=secret4me';</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To append trace information to the specified file, use the
<span style="font-family: Courier;">traceFileAppend=true</span> URL attribute in addition to 
<span style="font-family: Courier;">traceFile=<span style="font-style: italic;">path</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "traceFile=path attribute" and "traceFileAppend=true
attribute" in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N123FB"></a><span></span><div style="font-weight: bold;">Implementing ClientDataSource tracing</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can use
one of three methods to collect tracing data while obtaining connections from
the ClientDataSource:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setLogWriter(java.io.PrintWriter)</span> method of ClientDataSource
and set the <span style="font-family: Courier;">PrintWriter</span> to a non-null value.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setTraceFile(String filename)</span> method of ClientDataSource.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setTraceDirectory(String dirname)</span> method of ClientDataSource
to trace each connection flow in its own file for programs that have multiple
connections.</div></td></tr></table></div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12434"></a><span></span><div style="font-weight: bold;">Implementing DriverManager tracing</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Use one of the
following two options to enable and collect tracing information while obtaining
connections using the DriverManager:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setLogWriter(java.io.PrintWriter)</span> method of DriverManager
and set the <span style="font-family: Courier;">PrintWriter</span> to a non null-value.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">traceFile=<span style="font-style: italic;">path</span></span> or <span style="font-family: Courier;">traceDirectory=<span style="font-style: italic;">path</span></span> URL
attributes to set these properties prior to creating the connection with the <span style="font-family: Courier;">DriverManager.getConnection()</span> method.
For more information, see "traceFile=path attribute" and "traceDirectory=path
attribute" in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></td></tr></table></div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12482"></a><span></span><div style="font-weight: bold;">Changing the default trace level</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The default trace
level is <span style="font-family: Courier;">ClientDataSource.TRACE_ALL</span>. You can choose the tracing
level by calling the <span style="font-family: Courier;">setTraceLevel(int level)</span> method or by
setting the <span style="font-family: Courier;">traceLevel=<span style="font-style: italic;">value</span></span> URL attribute:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String url = "jdbc:derby://samplehost.example.com:1528/mydb" +
 ";traceFile=/u/user1/trace.out" +
 ";traceLevel=" +
 org.apache.derby.jdbc.ClientDataSource.TRACE_PROTOCOL_FLOWS;
DriverManager.getConnection(url,"user1","secret4me");</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table shows the tracing levels you can set.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 8. </span>Available tracing levels and values</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Trace Level</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Value</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_NONE</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x0</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_CONNECTION_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x1</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_STATEMENT_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x2</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_RESULT_SET_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x4</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _DRIVER_CONFIGURATION</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x10</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_CONNECTS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x20</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_PROTOCOL_FLOWS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x40</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _RESULT_SET_META_DATA</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x80</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _PARAMETER_META_DATA</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x100</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_DIAGNOSTICS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x200</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_XA_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x800</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_ALL</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0xFFFFFFFF;</div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To specify more than one trace level, use one of the following
techniques:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use bitwise OR operators ( | ) with two or more trace values. For example,
to trace PROTOCOL flows and connection calls, specify this value for traceLevel:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">TRACE_PROTOCOL_FLOWS | TRACE_CONNECTION_CALLS</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use a bitwise complement operator ( ~ ) with a trace value to specify
all except a certain trace. For example, to trace everything except PROTOCOL
flows, specify this value for traceLevel:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">~TRACE_PROTOCOL_FLOWS</div></pre></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "traceLevel=value attribute" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div></div></div><div><a name="N1260F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsclientxmp"></a><div></div>Network client driver examples</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12618"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following examples specify the user and password URL attributes. 
To enable user authentication, the  property <span style="font-style: italic;">derby.connection.requireAuthentication</span>
must be set to true, otherwise, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
does not require a user name and password. For details on how to enable
user authentication, please see "Working with user authentication" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">For a multi-user product, you would
typically set it for the system in the <span style="font-style: italic;">derby.properties</span> file for your
server, since it is in a trusted environment. Below is a sample
<span style="font-style: italic;">derby.properties</span> file that conforms to these examples:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.connection.requireAuthentication=true
derby.authentication.provider=BUILTIN
derby.user.judy=no12see</div></pre></div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">&gt;
        Important: </span>  <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s
BUILTIN authentication mechanism is suitable only for development and testing
purposes. It is strongly recommended that production systems rely on LDAP or a
user-defined class for authentication. It is also strongly recommended that
production systems protect network connections with SSL/TLS.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12659"></a><span></span><div style="font-weight: bold;">Example 1</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example connects to the
default server name localhost on the default port, 1527, and to the database
sample.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/sample;user=judy;password=no12see</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1266D"></a><span></span><div style="font-weight: bold;">Example 2</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following example specifies both <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and Network Client
driver attributes:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/sample;create=true;user=judy;
password=no12see</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12687"></a><span></span><div style="font-weight: bold;">Example 3</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This example connects to the default server
name localhost on the default port, 1527, and includes the path in the database
name portion of the URL.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/c:/my-db-dir/my-db-name;user=judy;
password=no12see</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1269B"></a><span></span><div style="font-weight: bold;">Example 4</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to use
the network client driver to connect the network client to the Network Server:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String databaseURL = "jdbc:derby://localhost:1527/sample";
<span style="font-weight: bold;">//
// Load Derby Network Client driver class.
// If you are running on JDK 6 or higher, you do not
// need to invoke Class.forName(). In that environment, the
// network client driver loads automatically.
//</span>
Class.forName("org.apache.derby.jdbc.ClientDriver");
<span style="font-weight: bold;">// Set user and password properties</span>
Properties properties = new Properties();
properties.setProperty("user", "judy");
properties.setProperty("password", "no12see");
<span style="font-weight: bold;">// Get a connection</span>
Connection conn = DriverManager.getConnection(databaseURL, properties);</div></pre></div></div></div></div><div><a name="N126F8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminnsdatasources"></a><div></div>Accessing the Network Server by using a DataSource object</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The Network Server supports the 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client driver <span style="font-family: Courier;">DataSource</span> classes
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource</span> and
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource</span>
on all supported Java SE platforms.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If your client runs on the Java SE 6 platform, and if you want to use 
<span style="font-family: Courier;">DataSource</span> methods specific to the JDBC 4 API, use the
<span style="font-family: Courier;">DataSource</span> classes named
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource40</span> and
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource40</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
If your client is running on the Java SE 6 platform, all connection objects 
returned from the <span style="font-family: Courier;">DataSource</span> will be JDBC 4 connection objects,
whether or not you are using a <span style="font-family: Courier;">DataSource</span> whose name ends in
"40".
</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1276C"></a><span></span><div style="font-weight: bold;">Using statement caching</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> supports JDBC
statement caching, which can improve the performance of applications that use
<span style="font-family: Courier;">PreparedStatement</span> or <span style="font-family: Courier;">CallableStatement</span>
objects. Statement caching avoids the performance penalty incurred by going over
the network from the client to the server to prepare a statement that has
already been prepared on the same connection.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use statement caching, you must use an
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource</span> or an
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource40</span> object.
After you instantiate this object, perform these steps:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify the desired size of your statement cache by calling the
<span style="font-family: Courier;">setMaxStatements</span> method on the <span style="font-family: Courier;">DataSource</span>
object, specifying an argument greater than zero.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Call the <span style="font-family: Courier;">getPooledConnection</span> method on the
<span style="font-family: Courier;">DataSource</span> object to obtain a
<span style="font-family: Courier;">javax.sql.PooledConnection</span> object (a physical
connection).</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Call the <span style="font-family: Courier;">javax.sql.PooledConnection.getConnection</span> method
to obtain a <span style="font-family: Courier;">java.sql.Connection</span> object (a logical
connection).</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After you obtain a connection, use either prepared statements or callable
statements to interact with the database. Close each statement to return it to
the cache after you finish using it. The statements you create are held in the
cache on the client side and reused when needed.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See
<span style="color: blue;"><a href="#stmtcacheexmp">Statement caching example</a></span>
for a code example.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use of the JDBC statement cache makes each physical connection use more
memory. The amount depends on how many statements the connection is allowed to
cache and how many statements are actually cached.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you enable JDBC statement caching, error handling changes slightly. Some
errors that previously appeared when the <span style="font-family: Courier;">prepareStatement</span>
method was executed may now appear during statement execution. For example,
suppose you query a table using a prepared statement that is then cached. If the
table is deleted, the prepared statement that queries the table is not
invalidated. If the query is prepared again on the same connection, the cached
object is fetched from the cache, and the <span style="font-family: Courier;">prepareStatement</span> call
seems to have succeeded, although the statement has not actually been prepared.
When the prepared statement is executed, the error is detected on the server
side, and the client is notified.</div></div></div><div><a name="N128BB"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminnsdatasourcexmp"></a><div></div>DataSource access examples</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N128C8"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example uses <span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource</span> to
access the Network Server:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N128D7"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">org.apache.derby.jdbc.ClientDataSource ds =
   new org.apache.derby.jdbc.ClientDataSource();
ds.setDatabaseName("mydb");
ds.setCreateDatabase("create");  
ds.setUser("user");  
ds.setPassword("mypass"); 

// The host on which Network Server is running
ds.setServerName("localhost");

// The port on which Network Server is listening
ds.setPortNumber(1527);

Connection conn = ds.getConnection(); 
</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N128E1"></a><span></span><div style="font-weight: bold;">Statement caching example</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example uses 
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource</span> to
access the Network Server and use JDBC statement caching:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N128F6"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">org.apache.derby.jdbc.ClientConnectionPoolDataSource cpds = 
   new ClientConnectionPoolDataSource();

// Set the number of statements the cache is allowed to cache.
// Any number greater than zero will enable the cache.
cpds.setMaxStatements(20);

// Set other DataSource properties
cpds.setDatabaseName("mydb");
cpds.setCreateDatabase("create");
cpds.setUser("user");
cpds.setPassword("mypass"); 
cpds.setServerName("localhost");
cpds.setPortNumber(1527);

// This physical connection will have JDBC statement caching enabled.
javax.sql.PooledConnection pc = cpds.getPooledConnection();

// Create a logical connection.
java.sql.Connection con = pc.getConnection();

// Interact with the database.
java.sql.PreparedStatement ps = con.prepareStatement(
   "select * from myTable where id = ?");
...
ps.close(); // Inserts or returns statement to the cache
...
con.close();

// The next logical connection can gain from using the cache.
con = pc.getConnection();

// This prepare causes a statement to be fetched from the local cache.
PreparedStatement ps = con.prepareStatement(
   "select * from myTable where id = ?");
...

// To dispose of the cache, close the connection.
pc.close();
</div></pre></div></div></div></div><div><a name="N1291D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminapps811478"></a><div></div>XA and the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Both the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver and the Network Server provide XA support. The Network Server provides
DRDA level 7 support. DRDA clients that support XAMGR, such as the
Derby network client, can send XA requests to
the Network Server. </div></div><div><a name="N12A00"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsxawthdriver"></a><div></div>Using XA with the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12A1F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can access XA support for the Network Server by using the
network client driver's XA DataSource interface.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The interface <span style="font-family: Courier;">org.apache.derby.jdbc.ClientXADataSource</span> is 
available on all supported Java SE platforms. If your client runs on the 
Java SE 6 platform, and if you want to use XA DataSource methods specific to 
the JDBC 4 API, use the DataSource named 
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientXADataSource40</span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
If your client is running on the Java SE 6 platform, all connection objects 
returned from the DataSource will be JDBC 4 connection objects, whether or not
you are using the DataSource whose name ends in "40".
</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12A3E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example illustrates how to obtain an XA connection
with the network client driver:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">import org.apache.derby.jdbc.ClientXADataSource;
import javax.sql.XAConnection;
...

XAConnection xaConnection = null;
Connection conn = null;

ClientXADataSource ds = new ClientXADataSource();

ds.setDatabaseName ("sample");
ds.setCreateDatabase("create");

ds.setServerName("localhost");
ds.setPortNumber(1527);

xaConnection = ds.getXAConnection("auser", "shhhh");

conn = xaConnection.getConnection();</div></pre></div></div></div></div><div><a name="N12A6B"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsusingthederbytoolswiththene"></a><div></div>Using the Derby tools with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools <span style="font-family: Courier;">ij</span> and <span style="font-family: Courier;">dblook</span> work in embedded
mode and client/server mode.</div></div><div><a name="N12B56"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminapps811302"></a><div></div>Using the Derby ij tool with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12B7F"></a><span></span> To use the ij tool with the network client driver:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Start ij in
one of the following ways. For details, see "Starting ij" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Tools and Utilities Guide</span></span>.</span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>a.</div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Use a script.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Run the <span style="font-family: Courier;">ij.bat</span> script on Windows
systems and the <span style="font-family: Courier;">ij</span> script on UNIX systems. These scripts are located in
the <span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/bin</span> directory.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>b.</div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the ij tool using the 
<span style="font-family: Courier;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib/derbyrun.jar</span> file.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">java -jar derbyrun.jar ij</span></span></div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>c.</div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the ij tool by specifying the class name.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;"><span style="font-family: Courier;">java org.apache.derby.tools.ij</span></span></div></pre></div></div></td></tr></table></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Connect by specifying the URL:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt; CONNECT 'jdbc:derby://localhost:1527/sample'
	USER 'judy' PASSWORD 'no12see';</div></pre>See <span style="color: blue;"><a href="#radminappsclientxmp">Network client driver examples</a></span> for
additional URL examples.</div></div></td></tr></table></div></div></div><div><a name="N12C4F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminapps811345"></a><div></div>Using the Derby dblook tool with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12C78"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the dblook tool with the Network Client driver, make sure
the Network Server is running (see <span style="color: blue;"><a href="#tadmincbdjhhfd">Starting the Network Server</a></span>),
and then include the necessary <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and
Network Client driver connection attributes as part of the database URL, as
in the following example:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12C8F"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.tools.dblook -d 'jdbc:derby://localhost:1527/sample;
user=user1;password=secret4me;'</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For details on using the dblook tool, see the 
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Tools and Utilities Guide</span></span>.
</div></div></div></div></div><div><a name="N12CD8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminapps"></a><div></div>Differences between running Derby in embedded mode and using the Network
Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes the differences between running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in embedded mode and
using the Network Server. Note that there may be undocumented differences
that have not yet been identified.</div></div><div><a name="N12E01"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclientdiffs"></a><div></div>Differences between the embedded client and the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following are known differences that exist between the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver and the network client driver. Note that there may be undocumented
differences that have not yet been identified. Some differences with the network
client may be changed in future releases to match the embedded driver functionality.<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Error messages and SQLStates can differ between the network client and
embedded driver. Some SQLStates may be null when using the network client,
particularly for data conversion errors.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Multiple SQL exceptions and warnings will only return the SQLState of
the first exception when using the network client. The text of the additional
exceptions will be appended to the text of the first exception. See <span style="color: blue;"><a href="#radminapps811974">Error message differences</a></span>.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Treatment of error situations encountered during batch processing with java.sql.Statement, java.sql.PreparedStatement and java.sql.CallableStatement is different. With the embedded driver processing stops when an error is encountered; with the network client driver processing continues, but an appropriate value as defined in the java.sql.Statement api is returned in the resulting update count array.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>To use an encrypted user id and password, you need to have the IBM's Java
Cryptography Extension (JCE) Version 1.2.1 or later.</div></td></tr></table></div></div></div></div><div><a name="N12EAF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsresultsetdiffs"></a><div></div>Updatable result sets</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, the
functionality of updatable result sets in a server environment and in an
embedded environment are similar, with the exception of the following
differences:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The Network Client requires that there be at least one column in the select
list from the target table. For example, the following statement will fail
in a server environment:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">select 1, 2 from t1 for update of c11</div></pre>The
Network Client driver looks at both of the columns in the select list and
cannot determine the target table for update/delete by looking at the column
metadata. This requirement is not necessary in an embedded environment.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The embedded driver allows for statement name changes when there is an
open result set on the statement object. This is not supported in a server
environment.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Other differences between updatable result sets in a server or embedded
environment can be found in the following table.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 9. </span>Comparison of updatable result sets features in server and embedded
environments</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Feature</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Embedded Environment</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Server Environment</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateBytes on CHAR, VARCHAR, LONG VARCHAR datatypes</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Supported</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateTime on TIMESTAMP datatypes</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Supported</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateClob and updateBlob</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Supported</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr></tbody></table></div></div></div><div><a name="N12FC7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminapps811974"></a><div></div>Error message differences</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12FF0"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The Network Server reports only the first error or warning message
if multiple errors or warnings occur for a given statement. For example: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt; create table ai (x int, y int generated always as identity
	(increment by 200000000));
ij&gt; insert into ai (x) values (1),(2),(3),(4),(5),(6),(7),
(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18),(19);</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12FFF"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The Network Server generates the following error message and appends
the exception message to the error: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 42Z24: Overflow occurred in identity for column 'Y' in table 'AI':
SQLSTATE: 22003: The resulting value is outside the range 
for the data type INTEGER.</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1300E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver, however, would generate two SQL exceptions:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 42Z24: Overflow occurred in identity for column 'Y' in table 'AI'. 
</div></pre><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 22003: The resulting value is outside the range for the data type INTEGER.</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13029"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This is because the network client driver reports only one SQLException
or one SQLWarning per statement.</div></div></div></div><div><a name="N13096"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps49914"></a><div></div>User authentication differences</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode or when using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, you can enable or disable server-side user authentication. However,
when using the Network Server, the default security mechanism (<span style="font-family: Courier;">CLEAR_TEXT_PASSWORD_SECURITY</span>)
requires that you supply both the user name and password.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In addition to the default user name and password security mechanism, <span style="font-style: italic;">org.apache.derby.jdbc.ClientDataSource.CLEAR_TEXT_PASSWORD_SECURITY, </span><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server
supports the following security properties:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>UserID  (<span style="font-style: italic;">org.apache.derby.jdbc.ClientDataSource.USER_ONLY_SECURITY</span>)
<div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, you must specify only the <span style="font-family: Courier;">user</span> property.
All other mechanisms require you to specify both the user name and the password.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Encrypted UserID and encrypted password (<span style="font-style: italic;">org.apache.derby.jdbc.ClientDataSource.ENCRYPTED_USER_AND_PASSWORD_SECURITY</span>)    <div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, both password and
user id are encrypted.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Strong password substitution (<span style="font-style: italic;">org.apache.derby.jdbc.ClientDataSource.STRONG_PASSWORD_SUBSTITUTE_SECURITY</span>)
<div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, a strong password substitute is generated and 
used to authenticate the user with the network server. The original password is 
never sent in any form across the network.</div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The user's name that is specified upon connection is the default schema
for the connection, if a schema with that name exists. See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information on schema and user names.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you specify any other security mechanism, you will receive an exception.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To change the default, you can specify another security mechanism either
as a property or on the URL (using the <span style="font-family: Courier;">securityMechanism=value</span> attribute) when making
the connection. For details, see
<span style="color: blue;"><a href="#cadminappsclientsecurity">Network client security</a></span> and
"securityMechanism=value attribute" in the 
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Whether the security mechanism you specify for the client actually takes
effect depends upon the setting of the 
<span style="font-family: Courier;">derby.drda.securityMechanism</span> property for the Network Server. 
If the <span style="font-family: Courier;">derby.drda.securityMechanism</span> property is set, the 
Network Server accepts only connections that use the security mechanism 
specified by the property setting. If the 
<span style="font-family: Courier;">derby.drda.securityMechanism</span> property is not set, clients can
use any valid security mechanism. For details, see 
<span style="color: blue;"><a href="#radmindrdasecmechanism">derby.drda.securityMechanism property</a></span>.</div></div><div><a name="N1322F"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps811631"></a><div></div>Security mechanism options when user authentication is enabled on the 
Network Server: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When user authentication is enabled in 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can use any of
the following security mechanisms:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Clear text user name and password security, the default</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Strong password substitute security </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Encrypted user name and password security</div></td></tr></table></div></div></div><div><a name="N13294"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps811656"></a><div></div>Security mechanism options when user authentication is disabled on the 
Network Server: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When user authentication is turned off in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can use any
of the security mechanism options.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You must provide a user and password for all security mechanisms except <span style="font-style: italic;">USER_ONLY_SECURITY</span>. However, because user authentication
is disabled in the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> server, the user name and password that you supply does not have to be one recognized as valid by <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</div></div></div><div><a name="N132FD"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps811695"></a><div></div>Enabling the encrypted user ID and password security mechanism: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the encrypted user ID and password security mechanism,
you need a Java environment with a JCE (Java Cryptography Extension)
which supports the Diffie-Hellman algorithm with a public prime of
256 bits. The Sun Java Platform, Standard Edition, Version
1.4 (J2SE) and later requires a public prime of 512 bits or
more. An alternative mechanism if the 256 bit public prime is not
supported, is <span style="font-style: italic;">STRONG_PASSWORD_SUBSTITUTE_SECURITY</span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">To use the encrypted user id and password security mechanism during
JDBC connection using the network client, specify the <span style="font-family: Courier;">securityMechanism</span> in
the connection property. <div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  If an encrypted database is booted in
the Network Server, users can connect to the database without giving the <span style="font-family: Courier;">bootPassword</span>.
The first connection to the database must provide the <span style="font-family: Courier;">bootPassword</span>,
but all subsequent connections do not need to supply it. To remove access
from the encrypted database, use the <span style="font-family: Courier;">shutdown=true</span> option
to shut down the database.</div></div></div></div></div><div><a name="N13388"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsjdbcdiffs"></a><div></div>Differences in JDBC 3.0 methods</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following JDBC 3.0 methods are supported only with the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded driver. 
Attempts to call these methods with the network client driver will result in 
a "not implemented" error.
</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
Connection.prepareStatement(String sql, String[] columnNames)
Connection.prepareStatement(String sql, int[] columnIndexes)

Statement.execute(String sql, String[] columNames)
Statement.execute(String sql, int[] columIndexes)
Statement.executeUpdate(String sql, String[] columnNames)
Statement.executeUpdate(String sql, int[] columnIndexes)
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more on the use of these methods, see the sections "java.sql.Connection 
interface: supported JDBC 3.0 methods", "java.sql.Statement interface: 
supported JDBC 3.0 methods", and "Autogenerated keys" in the 
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div></div><div><a name="N1342B"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsdiffsreadonly"></a><div></div>Differences using the Connection.setReadOnly method</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the embedded mode, when the Connection.setReadOnly method has <span style="font-family: Courier;">true</span> as
the parameter, the connection is marked as a read-only connection. When using
a Network Server, the Connection.setReadOnly(true) method is ignored and the
connection is not marked as a read-only connection.</div></div></div></div><div><a name="N134B9"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminappssettingportnumbers"></a><div></div>Setting port numbers</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N134E2"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> using
the Network Server listens on TCP/IP port number 1527. If you want to use
a different port number, you can specify it on the command line when starting
the Network Server. For example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl start -p 1088</div></pre></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">However, it is better to specify the port numbers by using any
of the following methods</span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Change the startNetworkServer.bat or startNetworkServer.ksh scripts </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">derby.drda.portNumber</span> property in <span style="font-family: Courier;">derby.properties</span></div></td></tr></table></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1351D"></a><span></span>See <span style="color: blue;"><a href="#tadmincbdjhhfd">Starting the Network Server</a></span> for more
information.</div></div></div></div><div><a name="N135D0"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminconfig86869"></a><div></div>Managing the Derby Network Server</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
    Server can be run in either of these configurations:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>As <span style="color: blue;"><a href="http://db.apache.org/derby/papers/DerbyTut/ns_intro.html#ns_intro">a stand-alone server</a></span>,
            in which case it is an independent Java process embedding the 
            <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
            database engine</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>As <span style="color: blue;"><a href="http://db.apache.org/derby/papers/DerbyTut/ns_intro.html#Embedded+Server">an embedded server</a></span>,
            in which case it is embedded within another Java application,
            and both the Network Server framework and the 
            <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
            database engine are loaded by the Java application</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use Java Management Extensions (JMX) technology to monitor and manage
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and the Network Server. For information on how
to do this, visit the wiki page
<span style="color: blue;"><a href="http://wiki.apache.org/db-derby/DerbyJMX">http://wiki.apache.org/db-derby/DerbyJMX</a></span> and refer to
the API documentation for the packages <span style="font-family: Courier;">org.apache.derby.mbeans</span>
and <span style="font-family: Courier;">org.apache.derby.mbeans.drda</span>. For information on JMX
technology, see
<span style="color: blue;"><a href="http://download.oracle.com/javase/6/docs/technotes/guides/jmx/">http://download.oracle.com/javase/6/docs/technotes/guides/jmx/</a></span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
You can manage the Network Server by using shell scripts, the command line,
or the Network Server API.
    The Network Server can also be managed remotely from a web server by
    using a servlet interface.
See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about starting and shutting down the Network Server using the
servlet interface.</div></div><div><a name="N136DB"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminconfigoverview"></a><div></div>Overview</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You start the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server using the command line or using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Server
API. (<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
scripts for you to use to start the server from the command line.) Before
starting the server, you will probably set certain <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and
Network Server properties.</div></div><div><a name="N13751"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig813694"></a><div></div>Using the NetworkServerControl API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13775"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You need to create an instance of the NetworkServerControl class
if you are using the API. There are four constructors for this class:</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Before
enabling connections from other systems, ensure that you are running under
a security manager.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl()</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This constructor
creates an instance that listens either on the default port (1527) or the
port that is set by the <span style="font-family: Courier;">derby.drda.portNumber</span> property. It
will also listen on the host set by the <span style="font-family: Courier;">derby.drda.host</span> property
or the loopback address if the property is not set. This is the default constructor;
it does not allow remote connections. It is equivalent to calling NetworkServerControl(InetAddress.getByName("localhost"),1527)
if no properties are set.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl(InetAddress address, int portNumber)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">This constructor creates an instance that listens on
the specified <span style="font-family: Courier;">portNumber</span> on the specified address. The <span style="font-family: Courier;">InetAddress</span> will
be passed to <span style="font-family: Courier;">ServerSocket</span>. NULL is an invalid address value.
 The following examples show how you might allow Network Server to accept
connections from other hosts: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//accepts connections from other hosts on an IPv4 system
NetworkServerControl serverControl = 
  new NetworkServerControl(InetAddress.getByName("0.0.0.0"),1527);</div></pre><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//accepts connections from other hosts on an IPv6 system
NetworkServerControl serverControl = 
  new NetworkServerControl(InetAddress.getByName("::"),1527);</div></pre></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl(String userName, String password)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a network server should run with user authentication,
certain operations like NetworkServerControl.shutdown()
require that you provide user credentials. This constructor creates an instance
with user credentials, which are then used for operations
that require them. In all other aspects, this constructor behaves like
NetworkServerControl().</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl(InetAddress address, int portNumber, String userName, String password)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This constructor creates an instance with user
credentials, which are then used for operations that require them. In
all other aspects, this constructor behaves like
NetworkServerControl(InetAddress address, int portNumber).</div></div></div></td></tr></table></div></div></div></div><div><a name="N13817"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigsettingnetwrokserverproperties"></a><div></div>Setting Network Server properties</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13840"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can specify Network Server properties in three ways: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the command line</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>In the <span style="font-family: Courier;">.bat</span> or <span style="font-family: Courier;">.ksh</span> files (loading the
properties by executing <span style="font-family: Courier;">java -D</span>)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>In the <span style="font-family: Courier;">derby.properties</span> file. </div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Properties in the command line or in the <span style="font-family: Courier;">.bat </span>or <span style="font-family: Courier;">.ksh</span> files
take precedence over the properties in the <span style="font-family: Courier;">derby.properties</span> file.
Arguments included on commands that are issued on the command line take precedence
over property values.</div></div></div><div><a name="N1397F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdahost"></a><div></div>derby.drda.host property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13999"></a><span></span>Causes the Network Server to listen on a specific network interface.
This property allows multiple instances of Network Server to run on a single machine,
each using its own unique host:port combination. The host needs to be set
to enable remote connections. By default, the Network Server will listen only
on the loopback address. If the property is set to 0.0.0.0, Network Server
will listen on all interfaces. Ensure that you are running under the security
manager and that user authorization is enabled before you enable remote
connections with this property. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1399E"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.host=<span style="font-style: italic;">hostname</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N139B2"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If no host name is specified, the Network Server
listens on the loopback address of the current machine (localhost).</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N139C0"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.host=myhost</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N139D3"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the
Network Server for changes to take effect.</div></div></div></div><div><a name="N13AA7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdakeepalive"></a><div></div>derby.drda.keepAlive property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13AC1"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Indicates whether SO_KEEPALIVE is enabled on sockets. The keepAlive
mechanism is used to detect when clients disconnect unexpectedly.  A <span style="font-style: italic;">keepalive
probe</span> is sent to the client if a long time (by default, more than two
hours) passes with no other data being sent or received.
The <span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>.drda.keepAlive property is used to detect and clean up connections for
clients on powered-off machines or clients that have disconnected unexpectedly.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13AD6"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the property is set to false, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> will
not attempt to clean up disconnected clients. The keepAlive mechanism might
be disabled if clients need to resume work without reconnecting even after
being disconnected from the network for some time. To disable keepAlive probes
on Network Server connections, set this property to false.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13AE5"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.keepAlive=[true|false] </div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13AF4"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">True.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B02"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drdra.keepAlive=false </div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B11"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N13BE5"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigdb2jdrdalogconnections"></a><div></div>derby.drda.logConnections property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13BFF"></a><span></span>Indicates whether to log connections. Also controls the logging of
the connection number. Connection number tracing, if enabled, goes to both
the <span style="font-family: Courier;">derby.log</span> file and the network server console.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C0A"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.logConnections=[true|false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C19"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C27"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.logConnections=true </span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C3A"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server
has been started.</div></div></div></div><div><a name="N13D0E"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdamaxthreads"></a><div></div>derby.drda.maxThreads property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D28"></a><span></span>Use the derby.drda.maxThreads property to set a maximum number of
connection threads that Network Server will allocate. If all of the connection
threads are currently being used and the Network Server has already allocated
the maximum number of threads, the threads will be shared by using the derby.drda.timeSlice
property to determine when sessions will be swapped.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D2D"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.maxThreads=<span style="font-style: italic;">numthreads</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D45"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D53"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.maxThreads=50</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D66"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N13E3A"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdaminthreads"></a><div></div>derby.drda.minThreads property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E54"></a><span></span>Use the derby.drda.minThreads property to set the minimum number
of connection threads that Network Server will allocate. By default, connection
threads are allocated as needed.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E59"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.minThreads=<span style="font-style: italic;">numthreads</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E71"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E7F"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.minThreads=10</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E92"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the
Network Server for changes to take effect.</div></div></div></div><div><a name="N13F66"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigportnumber"></a><div></div>derby.drda.portNumber property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13F80"></a><span></span>Indicates the port number to use. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13F85"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.portNumber=<span style="font-style: italic;">portnumber</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13F99"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If no port number is specified, 1527 is
the default.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FA7"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.portNumber=1110</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FBA"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N1408E"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdasecmechanism"></a><div></div>derby.drda.securityMechanism property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140B2"></a><span></span>The derby.drda.securityMechanism property restricts the client connections
based on the security mechanism. <div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the derby.drda.securityMechanism property
is set to a valid mechanism, the Network Server accepts only connections which
use that security mechanism. No other types of connections are accepted. 
If the derby.drda.securityMechanism property is not set, the Network Server
accepts any connection which uses a valid security mechanism.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140BC"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.securityMechanism = [ 
    USER_ONLY_SECURITY | 
    CLEAR_TEXT_PASSWORD_SECURITY | 
    ENCRYPTED_USER_AND_PASSWORD_SECURITY | 
    STRONG_PASSWORD_SUBSTITUTE_SECURITY 
] </span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140CF"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">None. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140DD"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.securityMechanism=USER_ONLY_SECURITY
</span></div></pre> The server that runs with this setting accepts only client
connections with the USER_ONLY_SECURITY value. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140F1"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for the changes that are associated with this property to take effect.</div></div></div></div><div><a name="N141C5"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdasslmode"></a><div></div>derby.drda.sslMode property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N141E9"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The derby.drda.sslMode property indicates whether the client
connection is encrypted or not, and whether certificate based peer
authentication is enabled.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N141F2"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
<span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.sslMode = [ off | basic | peerAuthentication ]</span>
</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14207"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-family: Courier;">off</span></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14219"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.sslMode=basic
</span></div></pre> The server that runs with this setting accepts client
connections encrypted with SSL.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1422D"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for the changes that are associated with this property to take effect.</div></div></div></div><div><a name="N14301"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigstartnetworkserver"></a><div></div>derby.drda.startNetworkServer property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1431B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the derby.drda.startNetworkServer property to simplify
embedding the Network Server in your Java application. When you set 
derby.drda.startNetworkServer to true, the Network Server will automatically 
start when you start <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
(in this context, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
will start when the embedded driver is loaded). Only one Network Server
can be started in a JVM.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">NOTE:
If you start the Network Server with this property set to true, the Network 
Server will stop when your application ends or when you stop it by other means 
(e.g. by using the Java API, the command line interface, or by shutting down 
the Derby system), whichever comes first.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14335"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.startNetworkServer=[true | false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14344"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14352"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.startNetworkServer=true</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14365"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must shut down the
Network Server and restart <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> for
this change to take effect.</div></div></div></div><div><a name="N1443F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdaStreamOutBufferSize"></a><div></div>derby.drda.streamOutBufferSize property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14459"></a><span></span>
Configure size of buffer for streaming blob/clob from server to client. 
If the configured size is 0 or less, the buffer is not placed.

<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  <div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This configuration is used when optimizing streaming blob/clob from server to client.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If there were found many small packets, of which sizes are much lower than maximum size of packet possible in the network,
it will improve performance of streaming to setting this configuration.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Recommended value of this configuration is maximum packet size possible in the network minus appropriate size for header.</div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14471"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.streamOutBufferSize=<span style="font-style: italic;">size of buffer</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14485"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14493"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.streamOutBufferSize=1024</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N144A6"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div><div><a name="N1457A"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdatimeslice"></a><div></div>derby.drda.timeSlice property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14594"></a><span></span>Use the derby.drda.timeSlice property to set the number of milliseconds
that each connection will use before yielding to another connection. This
property is relevant only if the derby.drda.maxThreads property is set
to a value greater than zero.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14599"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.timeSlice=<span style="font-style: italic;">milliseconds</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145B1"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145BF"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.timeSlice=2000</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145D2"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N146A6"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfig"></a><div></div>derby.drda.traceAll property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N146C0"></a><span></span>Turns tracing on for all sessions.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N146C5"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceAll=[true|false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N146D4"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N146E2"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.traceAll=true</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N146F5"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div><div><a name="N147C9"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigdb2jdrdatracedirectory"></a><div></div>derby.drda.traceDirectory property</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N147E3"></a><span></span>Indicates the location of tracing files.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N147E8"></a><span></span><div style="font-weight: bold;">Security Considerations</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">
    The Network Server will attempt to create the trace directory
    (and any parent directories) if they do not exist.
    This will require that the Java security policy for 
    <span style="font-family: Courier;">derbynet.jar</span>
    permits verification of the existence of the named trace directory
    and all necessary parent directories.
    For each directory created, the policy must allow
    <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
    permission java.io.FilePermission "&lt;<span style="font-style: italic;">directory</span>&gt;", "read,write";
    </div></pre>
    and for the trace directory itself, the policy must allow
    <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
    permission java.io.FilePermission "&lt;<span style="font-style: italic;">tracedirectory</span>&gt;${/}-", "write";
    </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
    See <span style="color: blue;"><a href="#tadminnetservcustom">Customizing the Network Server's security policy</a></span> for
    information about customizing the Network Server's security policy.
</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14822"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceDirectory=<span style="font-style: italic;">tracefiledirectory</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14836"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the derby.system.home property
        has been set, it is the default. Otherwise, the default is the current directory.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14844"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.traceDirectory=c:/<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>/trace</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1485D"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div></div><div><a name="N14931"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigverifyingstartup"></a><div></div>Verifying Startup</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To verify that the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server is currently running, use the ping command.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1495B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the ping command in the following ways:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the scripts NetworkServerControl.bat for Windows systems
or NetworkServerControl.ksh for UNIX systems with the <span style="font-weight: bold;">ping</span> command.
For example:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl ping [-h &lt;<span style="font-style: italic;">hostname</span>&gt;;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;]</div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
   ping [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl API to verify startup from
within a Java application: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ping(); </div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N149BF"></a><span></span>The following example uses a method to verify startup. It will try
to verify for the specified number of seconds: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">private static boolean isServerStarted(NetworkServerControl server, int ntries)
	{
		for (int i = 1; i &lt;= ntries; i ++)
		{
			try {
				Thread.sleep(500);
				server.ping();
				return true;
			}
			catch (Exception e) {
				if (i == ntries)
					return false;
			}
		}
		return false;
	}</div></pre></div></div></div></div><div><a name="N14A04"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminservlet98430"></a><div></div>Managing the Derby Network Server remotely by using the servlet interface</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the servlet interface to manage the Network Server
remotely. To use the servlet interface, the servlet must be registered with
an Application Server, and derby.system.home must be known to the Application Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A Web application archive (WAR) file, <span style="font-style: italic;">derby.war</span>, for the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
Network Server is available in <span style="font-style: italic;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib.</span> This
file registers the Network Server's servlet at the relative path <span style="font-style: italic;">/derbynet</span>.
See the documentation for your Application Server for instructions on how
to install it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, if <span style="font-style: italic;">derby.war</span> is installed in WebSphere Application
Server with a context root of <span style="font-family: Courier;">derby</span>, the URL of the server
is:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">http://&lt;server&gt;[:port]/derby/derbynet</div></pre><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Notes: </span>  <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>A servlet engine is not part of the Network Server.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When the Network Server is started by the servlet interface, shutting down
the Application Server also shuts the Network Server down, since both run in the
same JVM.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The servlet takes the following optional configuration parameters:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">host</span></div><div style="margin-left: 72pt + 16pt;">Specifies the host name to be used by the Network Server.
See the Security Considerations section below.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">portNumber</span></div><div style="margin-left: 72pt + 16pt;">Specifies the port number to be used by the Network Server.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">startNetworkServerOnInit</span></div><div style="margin-left: 72pt + 16pt;">Specifies that the Network Server is to be started when the servlet is
initialized.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">tracingDirectory</span></div><div style="margin-left: 72pt + 16pt;">Specifies the location for trace files. If the tracing directory is not
specified, the traces are placed in <span style="font-style: italic;">derby.system.home</span>.</div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14AA7"></a><span></span><div style="font-weight: bold;">Security Considerations</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For general security considerations for the Network Server, see
<span style="color: blue;"><a href="#cadminnetservsecurity">Network Server security</a></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
The "host" parameter allows configuration of the host name that will
be used for the listening socket for network connections. By default,
the Network Server will listen to requests only on the loopback
address, which means that it will only accept connections from the
local host. Changing this value could expose the server to
external connections, which raises security concerns, so before using
the "host" parameter, you should run under the Java security
manager and enable user authentication.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes the servlet pages.</div></div></div><div><a name="N14B75"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810694"></a><div></div>Start-up page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Use the start-up page to start the server.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14B99"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In addition to starting the Network Server, you can use the startup
page to perform the following actions:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Turn logging on when the server is started. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Turn tracing on for all sessions when the server is started. </div></td></tr></table></div></div></div></div><div><a name="N14C05"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810717"></a><div></div>Running page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14C24"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the Network Server is running (whether it was started by initializing
the servlet or in some other manner), the running page is displayed. The running
page indicates whether logging is on or off, whether tracing is on or off,
and if tracing is on, indicates for which session.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14C2D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the running page to stop the server and turn logging and tracing
on or off. The following options are available
from the running page:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14C36"></a><span></span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Start or stop logging. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Start or stop tracing all sessions. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify session to trace. (If you choose this option, the Trace session
page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Change tracing directory (If you choose this option, the Trace directory
page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify threading parameters for Network Server. (If you choose this option,
the Thread parameters page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Stop the Network Server.</div></td></tr></table></div></div></div></div><div><a name="N14CB0"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810796"></a><div></div>Trace session page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14CBD"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If on the running page you choose to specify a session to trace, this page
is displayed. You must enter the Session ID. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14CC6"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You are given the option to turn tracing on or off or return to the previous
menu. When you push the Trace On/Off button, information indicating the current
tracing state is displayed.</div></div></div></div><div><a name="N14D23"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810822"></a><div></div>Trace directory page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14D30"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This page is displayed if the you choose to change the tracing directory
on the Running page. You must enter the Trace Directory. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14D39"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can either set a tracing directory, or you can return to the previous
menu. Additional information is displayed that indicates the current tracing
directory when you push the Set Directory button. </div></div></div></div><div><a name="N14D96"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810910"></a><div></div>Set Network Server parameters </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14DA3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The first page is displayed if the thread parameter button is
pressed. Use this page to set the new parameters. Enter the following information:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14DAC"></a><span></span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>New maximum number of threads</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>New thread time slice</div></td></tr></table></div>If either the maximum threads or time slice parameters are left blank,
that value is left unchanged from the current setting. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14DBF"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Click Set Network Server parameters to display the updated values
for the maximum threads and the time slice parameters.</div></div></div></div></div><div><a name="N14E1C"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminadvtops"></a><div></div>Derby Network Server advanced topics</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section discusses several advanced topics for users of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server.</div></div><div><a name="N14EFE"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminnetservsecurity"></a><div></div>Network Server security</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server will only listen on the localhost. Clients must use the localhost host
name to connect. By default, clients cannot access the Network Server from
another host. To enable connections from other hosts, set the derby.drda.host
property, or start the Network Server with the <span style="font-family: Courier;"><span style="font-style: italic;">-h</span></span> option
in the <span style="font-family: Courier;"><span style="font-style: italic;">java org.apache.derby.drda.NetworkServerControl start</span></span> command.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the following example the server will listen only on localhost and clients
cannot access the server from another host.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the following example, the server runs on host machine <span style="font-family: Courier;"><span style="font-style: italic;">sampleserver.example.com</span></span> and
also listens for clients from other hosts. Clients must specify the server
in the URL or DataSource as sampleserver.example.com:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start 
   -h sampleserver.example.com</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">To start the Network Server so that it will listen on all interfaces, start
with an IP address of <span style="font-family: Courier;"><span style="font-style: italic;">0.0.0.0</span></span>, shown in the following
example:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start -h 0.0.0.0</span></div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A server that is started with the <span style="font-family: Courier;"><span style="font-style: italic;">-h 0.0.0.0</span></span> option
will listen to client requests that originate from both <span style="font-family: Courier;"><span style="font-style: italic;">localhost</span></span> and
from other machines on the network.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">However, administrative commands (for example, <span style="font-family: Courier;"><span style="font-style: italic;">org.apache.derby.drda.NetworkServerControl
shutdown</span></span>) can run only on the host where the server was started,
even if the server was started with the <span style="font-family: Courier;"><span style="font-style: italic;">-h</span></span> option.</div></div></div><div><a name="N15026"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminnetservrun"></a><div></div>Running the Network Server under the security manager</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15045"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
By default, the Network Server boots with a Basic security policy. You
are encouraged to customize this policy to fit the security needs of
your application and its runtime environment. You may also run the
Network Server without a security manager, although this is not recommended.
</div></div></div><div><a name="N150EF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminnetservbasic"></a><div></div>Basic Network Server security policy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1510E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> If you boot the Network Server without specifying a security
manager, the Network Server will install a default Java security manager enforcing
a Basic policy. This happens if you boot the Network Server as your VM's entry
point, e.g.: </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
java org.apache.derby.drda.NetworkServerControl start ...
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that you should run your Network Server with user
authentication and user authorization enabled. For details on how to enable user
authentication, see "Working with user authentication" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>. For information on user
authorization, see "Users and authorization identifiers" and "User
authorizations" in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> Some
of your application code may run as procedures and functions which you have
declared using the CREATE PROCEDURE and CREATE FUNCTION statements. You will
need to add privileged blocks to your declared procedures and functions if
they perform sensitive operations such as file and network i/o, classloading,
system property reading, etc.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> If for some reason you do not want
to run your client/server application under a security manager, you may override
the Network Server's impulse to install a default policy. For details, see <span style="color: blue;"><a href="#tadminnetservopen">Running the Network Server without a security policy</a></span>. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> Note that the Network Server
attempts to install a security manager only if you boot the server as the
entry point of your VM. The Network Server will not attempt to install a security
manager if you start the server from your application using the programmatic
API described in the following section: <span style="color: blue;"><a href="#tadminconfig814963">Starting the Network Server from a Java application</a></span>. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> You
will find a template security policy in the Derby distribution at <span style="font-style: italic;">demo/templates/server.policy</span>.
Most likely, you will want to customize this policy. For example, probably
you will want to restrict the server's liberal file i/o permissions which
let the server backup/restore and export/import to or from any location in the local file system.
For details on how to customize the Template policy, please see <span style="color: blue;"><a href="#tadminnetservcustom">Customizing the Network Server's security policy</a></span>.
The following example is a copy of the Basic policy: </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//
// This template policy file gives examples of how to configure the
// permissions needed to run a Derby network server with the Java
// Security manager.
//
grant codeBase "${derby.install.url}derby.jar"
{
//
// These permissions are needed for everyday, embedded Derby usage.
//
  permission java.lang.RuntimePermission "createClassLoader";
  permission java.util.PropertyPermission "derby.*", "read";
  permission java.util.PropertyPermission "user.dir", "read";
  permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
      "write"; 
  // The next two properties are used to determine if the VM is 32 or 64
  // bit.
  permission java.util.PropertyPermission "sun.arch.data.model", "read";
  permission java.util.PropertyPermission "os.arch", "read";
  permission java.io.FilePermission "${derby.system.home}","read";
  permission java.io.FilePermission "${derby.system.home}${/}-", 
      "read,write,delete";

//
// This permission lets a DBA reload the policy file while the server
// is still running. The policy file is reloaded by invoking the
// SYSCS_UTIL.SYSCS_RELOAD_SECURITY_POLICY() system procedure.
//
  permission java.security.SecurityPermission "getPolicy";

//
// This permission lets you backup and restore databases
// to and from arbitrary locations in your file system.
//
// This permission also lets you import/export data to and from
// arbitrary locations in your file system.
//
// You may want to restrict this access to specific directories.
//
  permission java.io.FilePermission "&lt;&lt;ALL FILES&gt;&gt;",
      "read,write,delete";


//
// Permissions needed for JMX based management and monitoring, which is
// only available for JVMs supporting "platform management", that is
// Java SE 5.0 or better.
//
// Allows this code to create an MBeanServer:
//
  permission javax.management.MBeanServerPermission "createMBeanServer";
//
// Allows access to Derby's built-in MBeans, within the domain
// org.apache.derby.
// Derby must be allowed to register and unregister these MBeans.
// It is possible to allow access only to specific MBeans, attributes or 
// operations. To fine tune this permission, see the javadoc of 
// javax.management.MBeanPermission or the JMX Instrumentation and Agent 
// Specification. 
//
  permission javax.management.MBeanPermission 
      "org.apache.derby.*#[org.apache.derby:*]",
      "registerMBean,unregisterMBean";
//
// Trusts Derby code to be a source of MBeans and to register these in
// the MBean server.
//
  permission javax.management.MBeanTrustPermission "register";

  // getProtectionDomain is an optional permission needed for printing
  // classpath information to derby.log
  permission java.lang.RuntimePermission "getProtectionDomain";

  //
  // The following permission must be granted for
  // Connection.abort(Executor) to work. Note that this permission
  // must also be granted to outer (application) code domains.
  //
  permission java.sql.SQLPermission "callAbort";
};

grant codeBase "${derby.install.url}derbynet.jar"
{
//
// This permission lets the Network Server manage connections from
// clients.
//

// Accept connections from any host. Derby is listening to the host
// interface specified via the -h option to "NetworkServerControl
// start" on the command line, via the address parameter to the
// org.apache.derby.drda.NetworkServerControl constructor in the API
// or via the property derby.drda.host; the default is localhost.
// You may want to restrict allowed hosts, e.g. to hosts in a specific
// subdomain, e.g. "*.example.com".

  permission java.net.SocketPermission "*", "accept"; 

//
// Needed for server tracing.
//
  permission java.io.FilePermission "${derby.drda.traceDirectory}${/}-",
      "read,write,delete";

//
// JMX: Uncomment this permission to allow the ping operation of the 
//      NetworkServerMBean to connect to the Network Server.
//permission java.net.SocketPermission "*", "connect,resolve";


//
// Needed by sysinfo. The file permission is needed to
// check the existence of jars on the classpath. You can
// limit this permission to just the locations which hold
// your jar files.
//
// In this template file, this block of permissions is granted
// to derbynet.jar under the assumption that derbynet.jar is
// the first jar file in your classpath which contains the
// sysinfo classes. If that is not the case, then you will want
// to grant this block of permissions to the first jar file
// in your classpath which contains the sysinfo classes.
// Those classes are bundled into the following Derby
// jar files:
//
//    derbynet.jar
//    derby.jar
//    derbyclient.jar
//    derbytools.jar
//
  permission java.util.PropertyPermission "user.*", "read";
  permission java.util.PropertyPermission "java.home", "read";
  permission java.util.PropertyPermission "java.class.path", "read";
  permission java.util.PropertyPermission "java.runtime.version", "read";
  permission java.util.PropertyPermission "java.fullversion", "read";
  permission java.lang.RuntimePermission "getProtectionDomain";
  permission java.io.FilePermission "&lt;&lt;ALL FILES&gt;&gt;", "read";
  permission java.io.FilePermission "java.runtime.version", "read";
  permission java.io.FilePermission "java.fullversion", "read";
};</div></pre></div></div></div><div><a name="N151A8"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminnetservcustom"></a><div></div>Customizing the Network Server's security policy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N151C7"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> The Network Server's Basic security policy is documented in
the section <span style="color: blue;"><a href="#tadminnetservbasic">Basic Network Server security policy</a></span>. Most likely, you
will want to customize your own security policy. For example, you might want
to restrict the server's liberal file i/o permissions which let the server
backup/restore and export/import to or from any location in the local file system. Customizing
the security policy is simple: </div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>A template policy lives in the Derby distribution at <span style="font-style: italic;">demo/templates/server.policy</span>.
Copy the file from this location to your own file, say <span style="font-style: italic;">myCustomized.policy</span>.
All of the following edits take place in your custom file.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Replace the <span style="font-style: italic;">${derby.install.url}</span> variable with the location of
the Derby jars in your local file system.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Replace the <span style="font-style: italic;">${derby.system.home}</span> variable with the location of
your Derby system directory. Alternatively, rather than replacing this variable,
you can simply set the value of the <span style="font-style: italic;">derby.system.home</span> system property
when you boot the server.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>You must grant <span style="font-style: italic;">java.net.SocketPermission</span> to
<span style="font-family: Courier;">derby.jar</span> if you are using LDAP authentication, so
that the Derby code is allowed to contact the LDAP server to perform
the authentication.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>You may want to restrict the socket permission for <span style="font-family: Courier;">derbynet.jar</span>,
which by default accepts connections from any host (<span style="font-family: Courier;">"*"</span>). 
Note that the special wildcard address <span style="font-family: Courier;">"0.0.0.0"</span> is not 
understood by SocketPermission, even though Derby accepts this wildcard as 
a valid value for accepting connections on all network interfaces (IPv4).</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Refine the file permissions needed by backup/restore, import/export, and
the loading of application jars.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example is a copy of a sample, customized policy file: </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
grant codeBase "file:/usr/local/share/sw/derby/lib/derby.jar"
{
//
// These permissions are needed for everyday, embedded Derby usage.
//
  permission java.lang.RuntimePermission "createClassLoader";
  permission java.util.PropertyPermission "derby.*", "read";
  // The next two properties are used to determine if the VM is 32 or 64 bit.
  permission java.util.PropertyPermission "sun.arch.data.model", "read";
  permission java.util.PropertyPermission "os.arch", "read";
  permission java.util.PropertyPermission "user.dir", "read";
  permission java.io.FilePermission "/usr/local/shoppingCartApp/databases","read";
  permission java.io.FilePermission "/usr/local/shoppingCartApp/databases/-", 
      "read,write,delete";
  permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
      "write"; 

//
// This permission lets a DBA reload the policy file while the server
// is still running. The policy file is reloaded by invoking the
// SYSCS_UTIL.SYSCS_RELOAD_SECURITY_POLICY() system procedure.
//
  permission java.security.SecurityPermission "getPolicy";

//
// This permission lets you backup and restore databases
// to and from a selected branch of the local file system:
//
  permission java.io.FilePermission "/usr/local/shoppingCartApp/backups/-", "read,write,delete";
//
// This permission lets you import data from
// a selected branch of the local file system:
//
  permission java.io.FilePermission "/usr/local/shoppingCartApp/imports/-", "read";
//
// This permission lets you export data to
// a selected branch of the local file system:
//
  permission java.io.FilePermission "/usr/local/shoppingCartApp/exports/-", "write";
//
// This permission lets you load your databases with jar files of
// application code
//
  permission java.io.FilePermission "/usr/local/shoppingCartApp/lib/*", "read";

// LDAP server on localhost using default LDAP port 389:
  permission java.net.SocketPermission "localhost:389", "connect,resolve";  
};

grant codeBase "file:/usr/local/share/sw/derby/lib/derbynet.jar"
{
//
// This permission lets the Network Server manage connections from clients
// originating from the localhost, on any port.
//
  permission java.net.SocketPermission "localhost:0-", "accept"; 
};
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> After customizing the Basic policy, you may bring up the
Network Server as follows: </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
java -Djava.security.manager -Djava.security.policy=/usr/local/shoppingCartApp/lib/myCustomized.policy org.apache.derby.drda.NetworkServerControl start -h localhost
</div></pre></div></div></div><div><a name="N15286"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminnetservopen"></a><div></div>Running the Network Server without a security policy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N152A5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
You may override the Network Server's impulse to install a security
manager if, for some reason, you need to run your application outside
Java's security protections.
</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">CAUTION: </span>  
You incur a severe security risk by opening
up the server to all clients without limiting access via user
authentication and a security policy.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Use the <span style="font-style: italic;">-noSecurityManager</span> option to force the Network Server
to come up without a security manager. E.g.:
</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
java org.apache.derby.drda.NetworkServerControl start -h localhost -noSecurityManager
</div></pre></div></div></div></div><div><a name="N15300"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminnetservusrauth"></a><div></div>Running the Network Server with User Authentication</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1531F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
By default, the Network Server boots with user
authentication disabled. However, it is strongly recommended that you run your Network Server with user
authentication enabled. For details on how to enable user authentication,
please see "Working with user authentication" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>.
</div></div></div></div><div><a name="N153A4"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminssl"></a><div></div>Network encryption and authentication with SSL/TLS</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, all <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> network traffic
is unencrypted, with the exception of user names and user passwords
which may be encrypted separately (See <span style="color: blue;"><a href="#cadminappsclientsecurity">Network client security</a></span>). There
is also no network layer access control mechanism. For deployment
scenarios where these are possible security issues, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server
supports network security with Secure Socket Layer/Transport Layer
Security (SSL/TLS).
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">With SSL/TLS, the client/server communication protocol is encrypted
and both the client and the server may independently of each other
require certificate based authentication of the other part.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> It is assumed that the reader is somewhat familiar with SSL,
key pairs and certificates. This documentation is also based on the
Java Development Kit (JDK) and its <span style="font-family: Courier;">keytool</span> application.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> For the remainder of this section, the term <span style="font-style: italic;">SSL</span> is used
for SSL/TLS and the term <span style="font-style: italic;">peer</span> is used for the other part of the
communication (The server's <span style="font-style: italic;">peer</span> is the client and vice versa).
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">SSL for <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
(both for client and for server) operates in three possible modes:
<div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">off</span></div><div style="margin-left: 72pt + 16pt;">The default, no SSL encryption</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">basic</span></div><div style="margin-left: 72pt + 16pt;">SSL encryption, no peer authentication</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">peerAuthentication</span></div><div style="margin-left: 72pt + 16pt;">SSL encryption and peer authentication</div></div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Peer authentication may be set either on the server or on the client
or on both. Peer authentication means that the other side of the SSL
connection is authenticated based on a trusted certificate installed
locally. 
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Alternatively, a Certification Authority (CA) certificate may be
installed locally and the peer has a certificate signed by that
authority. How to achieve this is not descibed in this
document. Consult your Java environment documentation for details on
this.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Attention: </span>  <span style="font-style: italic;">If a plaintext client tries to communicate with an SSL server or an
SSL client tries to communicate with a plaintext server, the plaintext
side of the communication will see the SSL communication as noise and
report protocol errors.</span></div></div></div><div><a name="N15523"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminsslkeys"></a><div></div>Key and certificate handling</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For SSL operation, the server always needs a key pair. If the server
runs in peer authentication mode (the server authenticates the
clients), then each client needs its own key pair. In general, if one
end of the communication wants to authenticate its partner, then the
first end needs to install a certificate generated by the partner.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
The key pair is located in a file which is called a <span style="font-style: italic;">key store</span>
and the JDK's SSL provider needs the system properties
<span style="font-family: Courier;">javax.net.ssl.keyStore</span> and
<span style="font-family: Courier;">javax.net.ssl.keyStorePassword</span> to access the key
store.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
The certificates of trusted parties are installed in a file called a
<span style="font-style: italic;">trust store</span>. The JDK's SSL provider needs the system properties
<span style="font-family: Courier;">javax.net.ssl.trustStore</span> and
<span style="font-family: Courier;">javax.net.ssl.trustStorePassword</span> to access the trust
store.
</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15593"></a><span></span><div style="font-weight: bold;">Key pair generation</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Key pairs are generated with <span style="font-family: Courier;">keytool -genkey</span>. The
simplest way to generate a key pair is to do the following:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -genkey &lt;alias&gt; -keystore &lt;keystore&gt;</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-family: Courier;">keytool</span> will prompt for needed information like
identity details and passwords. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Consult the JDK documentation for more information on
<span style="font-family: Courier;">keytool</span>.
</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155C2"></a><span></span><div style="font-weight: bold;">Certificate generation</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Certificates are generated with <span style="font-family: Courier;">keytool -export</span>
as follows:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -export -alias &lt;alias&gt; -keystore &lt;keystore&gt; \
        -rfc -file &lt;certificate file&gt;</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The certificate file may then be distributed to the relevant parties.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155E1"></a><span></span><div style="font-weight: bold;">Certificate installation</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Installation of a certificate in a trust store is done with 
<span style="font-family: Courier;">keytool -import</span> as follows:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -import -alias &lt;alias&gt; -file &lt;certificate file&gt; \
        -keystore &lt;trust store&gt;</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155FB"></a><span></span><div style="font-weight: bold;">Examples</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Generate the server key pair:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -genkey -alias myDerbyServer -keystore serverKeyStore.key</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Generate a server certificate:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -export -alias myDerbyServer -keystore serverKeyStore.key \
        -rfc -file myServer.cert</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Generate a client key pair:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -genkey -alias aDerbyClient -keystore clientKeyStore.key</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Generate a client certficate:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -export -alias aDerbyClient -keystore clientKeyStore.key \
        -rfc -file aClient.cert</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Install a client certificate in the server's trust store:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -import -alias aDerbyClient -file aClient.cert 
        -keystore serverTrustStore.key</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Install the server certificate in a client's trust store:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">keytool -import -alias myDerbyServer -file myServer.cert 
        -keystore clientTrustStore.key</div></pre></div></div></div><div><a name="N1568E"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminsslserver"></a><div></div>Starting the server with SSL/TLS</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For server SSL/TLS, a server key pair needs to be generated. If the
server is going to do client authentication, the client sertificates
need to be installed in the trust store. These operations are
described in <span style="color: blue;"><a href="#cadminsslkeys">Key and certificate handling</a></span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">SSL at the server side is activated with the property
<span style="font-family: Courier;">derby.drda.sslMode</span> (default off) or the
<span style="font-family: Courier;">-ssl</span> option for the server start command. 
</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N156DF"></a><span></span><div style="font-weight: bold;">Starting the server with basic SSL encryption</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When the SSL mode is set to <span style="font-family: Courier;">basic</span>, the server will
only accept SSL encrypted connections.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The properties <span style="font-family: Courier;">javax.net.ssl.keyStore</span> and
<span style="font-family: Courier;">javax.net.ssl.keyStorePassword</span> need to be set with
the proper values.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15704"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djavax.net.ssl.keyStore=serverKeyStore.key \
     -Djavax.net.ssl.keyStorePassword=qwerty \
     -jar derbyrun.jar server start -ssl basic</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15713"></a><span></span><div style="font-weight: bold;">Starting a server which authenticates clients</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When the server's SSL mode is set to
<span style="font-family: Courier;">peerAuthentication</span>, then the server authenticates its
clients' identity in addition to encrypting network traffic. In this
situation, the server's <span style="font-style: italic;">trust store</span> must contain a certificate for
each client which will connect.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">javax.net.ssl.trustStore</span> and
<span style="font-family: Courier;">javax.net.ssl.trustStorePassword</span> need to be set in
addition to the properties above.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminsslclient">Running the client with SSL/TLS</a></span> for
client settings when the server does client authentication.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1574B"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djavax.net.ssl.keyStore=serverKeyStore.key \
     -Djavax.net.ssl.keyStorePassword=qwerty \
     -Djavax.net.ssl.trustStore=serverTrustStore.key \
     -Djavax.net.ssl.trustStorePassword=qwerty \
     -jar derbyrun.jar server start -ssl peerAuthentication</div></pre></div></div></div><div><a name="N157A2"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminsslclient"></a><div></div>Running the client with SSL/TLS</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Basic SSL encryption on the client is enabled either by the URL attribute
<span style="font-family: Courier;">ssl</span>, the property <span style="font-family: Courier;">ssl</span> or the
datasource attribute <span style="font-family: Courier;">ssl</span> set to <span style="font-family: Courier;">basic</span>.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N157F2"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Connection c = 
   getConnection("jdbc:derby://myhost:1527/db;ssl=basic");</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15801"></a><span></span><div style="font-weight: bold;">Running a client which authenticates the server</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the client wants to authenticate the server, then the client's
<span style="font-style: italic;">trust store</span> must contain the server's certificate. See <span style="color: blue;"><a href="#cadminsslkeys">Key and certificate handling</a></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Client SSL with server authentication is enabled by the URL
attribute <span style="font-family: Courier;">ssl</span> or the property <span style="font-family: Courier;">ssl</span>
set to <span style="font-family: Courier;">peerAuthentication</span>. In addition, the system
properties <span style="font-family: Courier;">javax.net.ssl.trustStore</span> and 
<span style="font-family: Courier;">javax.net.ssl.trustStorePassword</span> need to be set.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15840"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">    System.setProperty("javax.net.ssl.trustStore","clientTrustStore.key");
    System.setProperty("javax.net.ssl.trustStorePassword","qwerty");
    Connection c = 
       getConnection("jdbc:derby://myhost:1527/db;ssl=peerAuthentication");</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1584F"></a><span></span><div style="font-weight: bold;">Running the client when the server does client authentication</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the server does client authentication, the client will need a key
pair and a client certificate which is installed in the server's
<span style="font-style: italic;">trust store</span>, See <span style="color: blue;"><a href="#cadminsslkeys">Key and certificate handling</a></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The client needs to set <span style="font-family: Courier;">javax.net.ssl.keyStore</span> and
<span style="font-family: Courier;">javax.net.ssl.keyStorePassword</span>.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1587C"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">    System.setProperty("javax.net.ssl.keyStore","clientKeyStore.key");
    System.setProperty("javax.net.ssl.keyStorePassword","qwerty");
    Connection c = 
       getConnection("jdbc:derby://myhost:1527/db;ssl=basic");</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1588B"></a><span></span><div style="font-weight: bold;">Running the client when both parties do peer
authentication</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This is a combination of the two last variants.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15899"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">    System.setProperty("javax.net.ssl.keyStore","clientKeyStore.key");
    System.setProperty("javax.net.ssl.keyStorePassword","qwerty");
    System.setProperty("javax.net.ssl.trustStore","clientTrustStore.key");
    System.setProperty("javax.net.ssl.trustStorePassword","qwerty");
    Connection c = 
       getConnection("jdbc:derby://myhost:1527/db;ssl=peerAuthentication");</div></pre></div></div></div><div><a name="N158F0"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminssladmin"></a><div></div>Other server commands</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15923"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The other server commands (<span style="font-family: Courier;">shutdown</span>,
<span style="font-family: Courier;">ping</span>, <span style="font-family: Courier;">sysinfo</span>,
<span style="font-family: Courier;">runtimeinfo</span>, <span style="font-family: Courier;">logconnections</span>,
<span style="font-family: Courier;">maxthreads</span>, <span style="font-family: Courier;">timeslice</span>,
<span style="font-family: Courier;">trace</span>, <span style="font-family: Courier;">tracedirectory</span>) are 
implemented as <span style="color: blue;"><a href="#cadminsslclient">clients</a></span>, and they
behave exactly as clients with regards to SSL. The SSL mode is set
with the property <span style="font-family: Courier;">derby.drda.sslMode</span> or the server
command option <span style="font-family: Courier;">-ssl</span>.
</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15975"></a><span></span><div style="font-weight: bold;">Examples</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -jar derbyrun.jar server shutdown -ssl basic</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">will shut down an SSL-enabled server. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Similarly, if you have <span style="font-family: Courier;">peerAuthentication</span> on both sides, use the
following command: 
</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djavax.net.ssl.keyStore=clientKeyStore.key \
     -Djavax.net.ssl.keyStorePassword=qwerty \
     -Djavax.net.ssl.trustStore=clientTrustStore.key \   
     -Djavax.net.ssl.trustStorePassword=qwerty \
     -jar derbyrun.jar server shutdown -ssl peerAuthentication</div></pre></div></div></div></div><div><a name="N159E2"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfiguringthenetworkserver"></a><div></div>Configuring the Network Server to handle connections</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N159FC"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can configure the Network Server to use a specific number
of threads to handle connections. You can change the configuration on the
command line or by using the servlet interface.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The minimum number
of threads is the number of threads that are started when the Network Server
is booted. This value is specified as a property, <span style="font-family: Courier;">derby.drda.minThreads
= &lt;<span style="font-style: italic;">min</span>&gt;</span>. The maximum number of threads is the maximum
number of threads that will be used for connections. If more connections are
active than there are threads available, the extra connections must wait until the next
thread becomes available. Threads can become available after a specified time,
which is checked only when a thread has finished processing a communication.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can change the maximum number of threads by using the following
command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl maxthreads &lt;<span style="font-style: italic;">max</span>&gt; [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] 
[-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also use
the <span style="font-family: Courier;">derby.drda.maxThreads</span> property to assign the maximum
value. A &lt;<span style="font-style: italic;">max</span>&gt; value of 0 means that there is no maximum and
a new thread will be generated for a connection if there are no current threads
available. This is the default. The &lt;<span style="font-style: italic;">max</span>&gt; and &lt;<span style="font-style: italic;">min</span>&gt;
values are stored as integers, so the theoretical maximum is 2147483647 (the
maximum size of an integer). But the practical maximum is determined by the
machine configuration. </div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To change the time that a thread should work on one session's request
and check if there are waiting sessions, use the following command: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
timeslice &lt;<span style="font-style: italic;">milliseconds</span>&gt; [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also use the derby.drda.timeSlice property
to set this value. A value of 0 milliseconds indicates that the thread will
not give up working on the session until the session ends. A value of -1 milliseconds
indicates to use the default. The default value is 0. The maximum number of
milliseconds that can be specified is 2147483647 (the maximum size of an integer).</div></div></div></td></tr></table></div></div></div><div><a name="N15AFC"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminlogfile"></a><div></div>Controlling logging by using the log file</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15B25"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The Network Server uses the <span style="font-family: Courier;">derby.log</span> file to
log problems that it encounters. It also logs connections when the property <span style="font-family: Courier;">derby.drda.logConnections</span> is
set to <span style="font-family: Courier;">true</span>. The <span style="font-family: Courier;">derby.log</span> file is created
when the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> server
is started. The Network Server then records the time and version. If a log
file exists, it is overwritten, unless the property <span style="font-family: Courier;">derby.infolog.append</span> is
set to <span style="font-family: Courier;">true</span>. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> When the Network Server is logging connections,
it also logs the Connection Number; this log message is written both to the <span style="font-family: Courier;">derby.log</span> file
and to the Network Server console.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To turn on connection logging, you can use the servlet interface
or you can issue the following command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
   logconnections on [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To turn connection logging off you can use the servlet interface
or you can issue the following command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
   logconnections off [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15BA5"></a><span></span>See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information about the <span style="font-family: Courier;">derby.log</span> file.</div></div></div><div><a name="N15C30"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmintracefacility"></a><div></div>Controlling tracing by using the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15C59"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the trace facility only if you are working with technical
support and they require tracing information.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15C62"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about managing the trace facility using the servlet interface. </div></div></div><div><a name="N15D05"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminadv804410"></a><div></div>Turning on the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Turn on tracing for all sessions by specifying the following property:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceAll=true </div></pre>Alternatively, while
the Network Server is running, you can use the following command to turn on
the trace facility:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
   trace on [-s &lt;<span style="font-style: italic;">connection number</span>&gt;] [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you specify a &lt;<span style="font-style: italic;">connection number</span>&gt;, tracing will be turned
on only for that connection.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the location of the tracing files by specifying the following
property:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceDirectory=&lt;<span style="font-style: italic;">directory for tracing files</span>&gt;</div></pre>
Alternatively,
while the Network Server is running, enter the following command
to set the trace directory:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl traceDirectory 
&lt;<span style="font-style: italic;">directory for tracing files</span>&gt; [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;]  </div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You need to specify only the directory where the tracing files will
reside. The names of the tracing files are determined by the system. If you
do not set a trace directory, the tracing files will be placed in derby.system.home.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">
    The Network Server will attempt to create the trace directory
    (and any parent directories) if they do not exist.
    This will require that the Java security policy for 
    <span style="font-family: Courier;">derbynet.jar</span>
    permits verification of the existence of the named trace directory
    and all necessary parent directories.
    For each directory created, the policy must allow
    <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
    permission java.io.FilePermission "&lt;<span style="font-style: italic;">directory</span>&gt;", "read,write";
    </div></pre>
    and for the trace directory itself, the policy must allow
    <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
    permission java.io.FilePermission "&lt;<span style="font-style: italic;">tracedirectory</span>&gt;${/}-", "write";
    </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
    See <span style="color: blue;"><a href="#tadminnetservcustom">Customizing the Network Server's security policy</a></span> for
    information about customizing the Network Server's security policy.
</div></div></div></td></tr></table></div></div></div><div><a name="N15DCF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminadv804451"></a><div></div>Turning off the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15DD8"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Enter the following command to turn off tracing:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl trace off [-s &lt;<span style="font-style: italic;">connection number</span>&gt;] 
[-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The
tracing files are named ServerX.trace, where X is a connection number.</div></div></div></div></div></div><div><a name="N15E1C"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="radminsampleprograms"></a><div></div>Derby Network Server sample programs</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15E36"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes several <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server sample
programs for Network Server users.</div></div></div><div><a name="N15EC7"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminovnssample"></a><div></div>The NsSample sample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="font-style: italic;">NsSample</span> demonstration program is a simple JDBC application
that interacts with the Network Server.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15EF1"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The <span style="font-style: italic;">NsSample</span> program performs the following tasks: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts the Network Server. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Checks that the Network Server is running.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the Network Client driver. (Note that this step is not
necessary if you are running the client on JDK 1.6 or higher. In that
environment, the network client driver loads automatically.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Creates the <span style="font-style: italic;">NsSampledb</span> database if not already created. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Checks to see if the schema is already created, and if not, creates the
schema which includes the SAMPLETBL table and corresponding indexes. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Connects to the database.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the schema by inserting data. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts client threads to perform database related operations. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Has each of the clients perform DML operations (select, insert, delete,
update) using JDBC calls. For example, one client thread establishes an embedded
connection to perform database operations, while another client thread establishes
a client connection to the Network Server to perform database operations. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Waits for the client threads to finish the tasks. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Shuts down the Network Server at the end of the demonstration.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You must install the following files in the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory before you can run the sample program: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSample.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This is the entry point into the
sample program. The program starts up two client threads. The first client
establishes an embedded connection to perform database operations, and the
second client establishes a client connection to the Network Server to perform
database operations.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can change the following constants to modify
the sample program:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NUM_ROWS</span></div><div style="margin-left: 72pt + 32pt;">The number of rows that must be initially loaded into the schema.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">ITERATIONS</span></div><div style="margin-left: 72pt + 32pt;">The number of iterations for which each client thread does database related
work.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NUM_CLIENT_THREADS</span></div><div style="margin-left: 72pt + 32pt;">The number of clients that you want to run the program against.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NETWORKSERVER_PORT</span></div><div style="margin-left: 72pt + 32pt;">The port on which the Network Server is running.</div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleClientThread.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">This file contains two
Java classes:  <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The NsSampleClientThread class extends Thread and instantiates a NsSampleWork
instance. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The NsSampleWork class contains everything that is required to perform
DML operations using JDBC calls. The <span style="font-style: italic;">doWork</span> method in the NsSampleWork
class represents all the work done as part of this sample program. </div></td></tr></table></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NetworkServerUtil.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This file contains helper
methods to start the Network Server and to shutdown the server.</div></div></td></tr></table></div>The compiled class files for the NsSample program are:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSample.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleClientThread.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleWork.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NetworkServerUtil.class</span></div></td></tr></table></div></div></div></div><div><a name="N1603C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovnsrundemo"></a><div></div>Running the NsSample sample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16045"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run the NsSample program:  </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the CLASSPATH to the current directory (".") and also include
the following jar files in order to use the Network Server and the network
client driver:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbynet.jar</span></div><div style="margin-left: 72pt + 32pt;">The Network Server jar file. It must be in your CLASSPATH to use any of
the Network Server functions.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbyclient.jar</span></div><div style="margin-left: 72pt + 32pt;">This jar file must be in your CLASSPATH to use the Network Client driver.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database
engine jar file.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbytools.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools jar
file.</div></div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Test the CLASSPATH settings by running the following Java command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"> java org.apache.derby.tools.sysinfo</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This command shows the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> jar
files that are in the classpath as well as their respective versions.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>4. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the NsSample program
from the same directory: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java nserverdemo.NsSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output similar
to that shown in the following table:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server created
Server is ready to accept connections on port 1621.
Connection number: 1.
[NsSample] <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server started.
[NsSample] Sample <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server program demo starting.
Please wait .....................
Connection number: 2.
[NsSampleWork] Begin creating table - SAMPLETBL and necessary indexes.
[NsSampleClientThread] Thread id - 1; started.
[NsSampleWork] Thread id - 1; requests database connection, 
	dbUrl =jdbc:derby:NSSampledb;
[NsSampleClientThread] Thread id - 2; started.
[NsSampleWork] Thread id - 2; requests database connection, 
	dbUrl =jdbc:derby://localhost:1621/
	NSSampledb;deferPrepares=true;
Connection number: 3.
[NsSampleWork] Thread id - 1 selected 1 row [313,Derby36   ,1.7686243E23,9620]
[NsSampleWork] Thread id - 1 selected 1 row [313,Derby36   ,1.7686243E23,9620]
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 9620
[NsSampleWork] Thread id - 1 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 1 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 1; inserted 1 row.
[NsSampleWork] Thread id - 1 selected 1 row [52,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2; updated 1 row with t_key = 9547
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 9547
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 1; inserted 1 row.
[NsSampleWork] Thread id - 2; deleted 1 row with t_key = 9321
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 8707
[NsSampleWork] Thread id - 1; closed connection to the database.
[NsSampleClientThread] Thread id - 1; finished all tasks.
[NsSampleWork] Thread id - 2; deleted 1 row with t_key = 8490
[NsSampleWork] Thread id - 2; closed connection to the database.
[NsSampleClientThread] Thread id - 2; finished all tasks.
[NsSample] Shutting down Network Server.
Connection number: 4.
Shutdown successful.
</div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1610F"></a><span></span>Running the <span style="font-style: italic;">NsSample</span> program also creates the following new
directories and files:<div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NSSampledb</span></div><div style="margin-left: 72pt + 16pt;">This directory makes up the <span style="font-style: italic;">NSSampledb</span> database.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.log </span></div><div style="margin-left: 72pt + 16pt;">This log file contains <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> progress
and error messages.</div></div></div></div></div></div></div><div><a name="N16163"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminovntsrvsample"></a><div></div>Network Server sample programs for embedded and client connections</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">This <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server sample program demonstrates how to obtain an embedded connection and
client connections to the same database by using the Network Server. This
program shows how to use either the DriverManager or a DataSource to obtain
client connections.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a database to be consistent, only one JVM can access it at a time.
The embedded driver is loaded when the Network Server is started. The JVM
that starts the Network Server can obtain an embedded connection to the same
database that the Network Server is accessing to serve clients from other
JVMs. This solution provides the performance benefits of the embedded driver
and also allows client connections from other JVMs to connect to the same
database.</div></div><div><a name="N161FA"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminovsrvsmpprgm"></a><div></div>Overview of the SimpleNetworkServerSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SimpleNetworkServerSample program starts the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, as well as the embedded driver, and waits for clients to connect. The
program performs the following tasks.
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server by using a property and also loads the embedded driver</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Determines if the Network Server is running</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Creates the NSSimpleDB database if it is not already
created</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains an embedded database connection </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Tests the database connection by executing a sample query</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Allows client connections to connect to the server until you decide to
stop the server and exit the program</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Closes the connection</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Shuts down the Network Server before exiting the program</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"> To run the sample program, install the following files in
the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The source file: <span style="font-family: Courier;">SimpleNetworkServerSample.java</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The compiled class file: <span style="font-family: Courier;">SimpleNetworkServerSample.class</span></div></td></tr></table></div></div></div></div><div><a name="N162C1"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovrunsrvprgm"></a><div></div>Running the SimpleNetworkServerSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N162CA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server sample program: </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the classpath to include the current directory ("."), and the
following jar files: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbynet.jar</span></div><div style="margin-left: 72pt + 32pt;">The Network Server jar file. It must be in your CLASSPATH because you
start the Network Server in this program.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.jar</span></div><div style="margin-left: 72pt + 32pt;">The database engine jar file.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbytools.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools jar
file.</div></div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Test the CLASSPATH settings by running the following Java command:
 </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.tools.sysinfo</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This command displays the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> jar
files that are in the classpath.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>4. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the SimpleNetworkServerSample
program from the same directory:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java SimpleNetworkServerSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output that
is similar to that shown in the following exampleS: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Starting Network Server
Testing if Network Server is up and running!
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server now running
Got an embedded connection.
Testing embedded connection by executing a sample query
number of rows in sys.systables = 16
While my app is busy with embedded work, ij might connect like this:

        $ java -Dij.user=me -Dij.password=pw -Dij.protocol=
			jdbc:derby:\\localhost:1527\ org.apache.derby.tools.ij
        ij&gt; connect 'NSSimpleDB';

Clients can continue to connect:
Press [Enter] to stop Server</div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1637B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Running the SimpleNetworkServerSample program also creates the
following new directories and files:  <div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NSSimpleDB</span></div><div style="margin-left: 72pt + 16pt;">This directory makes up the NSSimpleDB database.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.log</span></div><div style="margin-left: 72pt + 16pt;">This log file contains <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> progress
and error messages.</div></div></div></div></div></div></div><div><a name="N163F1"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminovcliconnect"></a><div></div>Connecting a client to the Network Server with the SimpleNetworkClientSample
program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SimpleNetworkClientSample program is a client
program that interacts with the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server from another JVM.
The program performs the following tasks:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the network client driver. (Note that this step is not
necessary if you are running the client on JDK 1.6 or higher. In that
environment, the network client driver loads automatically.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains a client connection by using the DriverManager.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains a client connection by using a DataSource.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Tests the database connections by running a sample query.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Closes the connections and then exits the program.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You must install the following files in the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory before you can run the sample program:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The source file: <span style="font-family: Courier;">SimpleNetworkClientSample.java.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The compiled class file: <span style="font-family: Courier;">SimpleNetworkClientSample.class.</span></div></td></tr></table></div></div></div></div><div><a name="N164A3"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovclirun"></a><div></div>Running the SimpleNetworkClientSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N164AC"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To connect to the Network Server that has been started with the
SimpleNetworkServerSample program: </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the classpath to include the following jar files: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The current directory (".")</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>derbyclient.jar</div></td></tr></table></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the SimpleNetworkClientSample
program from the same directory: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java SimpleNetworkClientSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output similar
to that shown in the following example: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Starting Sample client program
Got a client connection via the DriverManager.
connection from datasource; 
Got a client connection via a DataSource.
Testing the connection obtained via DriverManager by executing a sample query
number of rows in sys.systables = 16
Testing the connection obtained via a DataSource by executing a sample query
number of rows in sys.systables = 16
Goodbye!</div></pre></div></div></td></tr></table></div></div></div></div></div></div><div><a name="N16554"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminparttwo"></a><div></div>Part two: Derby Administration Guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section of the guide is divided into several administrative tasks.
</div></div><div><a name="N165D7"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminconsist01"></a><div></div>Checking database consistency</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">If you experience hardware or operating system failure, you can use the SYSCS_UTIL.SYSCS_CHECK_TABLE function to verify that the database is still consistent.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Check consistency only if there are indications that such
a check is needed because a consistency check can take a long time on a large
database.</div></div><div><a name="N1669B"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist30301"></a><div></div>The SYSCS_CHECK_TABLE function</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N166B5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_CHECK_TABLE() function checks the consistency
of a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> table. In
particular, the <span style="font-style: italic;">SYSCS_UTIL.SYSCS_CHECK_TABLE</span> function verifies the
following conditions:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Base tables are internally consistent</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Base tables and all associated indexes contain the same number of rows</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The values and row locations in each index match those of the base table</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>All BTREE indexes are internally consistent</div></td></tr></table></div>You run this function in an SQL statement, as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N166E3"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE(
    <span style="font-style: italic;">SchemaName</span>, <span style="font-style: italic;">TableName</span>)</div></pre>where <span style="font-style: italic;">SchemaName</span> and <span style="font-style: italic;">TableName</span> are
expressions that evaluate to a string data type. If you created a schema or
table name as a non-delimited identifier, you must present their names in
all upper case. For example:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'CITIES')</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1670C"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_CHECK_TABLE function returns a smallint.
If the table is consistent (or if you run SYSCS_UTIL.SYSCS_CHECK_TABLE on
a view), SYSCS_UTIL.SYSCS_CHECK_TABLE returns a non-zero value. Otherwise,
the function throws an exception on the first inconsistency that it finds.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16715"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a consistent table, the following result is displayed:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1671E"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">1
-----
1

1 row selected</div></pre></div></div></div><div><a name="N16760"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist38781"></a><div></div>Sample SYSCS_CHECK_TABLE error messages</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">This section provides examples of error messages that the SYSCS_UTIL.SYSCS_CHECK_TABLE()
function can return.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1677F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the row counts of the base table and an index differ, error
message X0Y55 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16788"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0Y55: The number of rows in the base table does not match 
the number of rows in at least 1 of the indexes on the table. Index 
'T1_I' on table 'APP.T1' has 4 rows, but the base table has 5 rows. 
The suggested corrective action is to recreate the index.</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16792"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the index refers to a row that does not exist in the base table,
error message X0X62 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1679B"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0X62: Inconsistency found between table 'APP.T1' and index
'T1_I'. Error when trying to retrieve row location '(1,6)' from the 
table. The full index key,including the row location, is '{ 1, (1,6) }'.
The suggested corrective action is to recreate the index.</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N167A5"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a key column value differs between the base table and the index,
error message X0X61 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N167AE"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0X61: The values for column 'C10' in index 'T1_C10' and 
table 'APP.T1' do not match for row location (1,7). The value in the 
index is '2 2   ', while the value in the base table is 'NULL'. The full
index key, including the row location, is '{ 2 2       , (1,7) }'. The 
suggested corrective action is to recreate the index.</div></pre></div></div></div><div><a name="N167F1"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist24642"></a><div></div>Sample SYSCS_CHECK_TABLE queries</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16810"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section provides examples that illustrate how to use the
SYSCS_UTIL.SYSCS_CHECK_TABLE function in queries.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16819"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of a single table, run a query that is
similar to the one shown in the following example:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16822"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FLIGHTS')</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1682C"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of all of the tables in a schema, stopping
at the first failure, run a query that is similar to the one shown in the
following example:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16835"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SELECT tablename, SYSCS_UTIL.SYSCS_CHECK_TABLE(
    'SAMP', tablename)
FROM sys.sysschemas s, sys.systables t
WHERE s.schemaname = 'SAMP' AND s.schemaid = t.schemaid</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1683F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of an entire database, stopping at the
first failure, run a query that is similar to the one shown in the following
example::</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16848"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SELECT schemaname, tablename,
SYSCS_UTIL.SYSCS_CHECK_TABLE(schemaname, tablename)
FROM sys.sysschemas s, sys.systables t
WHERE s.schemaid = t.schemaid</div></pre></div></div></div></div><div><a name="N1688A"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminhubbkup98797"></a><div></div>Backing up and restoring databases</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
a way to back up a database while it is online. You can also restore a full
backup from a specified location.</div></div><div><a name="N16955"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminbckupdb"></a><div></div>Backing up a database</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The topics in this section describe how to back up a database.</div></div><div><a name="N169E7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup12677"></a><div></div>Offline backups</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To perform an offline backup of a database, use operating system
commands to copy the database directory. You must shut down the database prior
to performing an offline backup. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, on Windows systems, the following operating system command 
backs up a (closed) database that is named <span style="font-style: italic;">sample</span> and that is located in <span style="font-family: Courier;">d:\mydatabases</span> by
copying it to the directory <span style="font-family: Courier;">c:\mybackups\2005-06-01</span>:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">xcopy d:\mydatabases\sample c:\mybackups\2005-06-01\sample /s /i</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are not using Windows, substitute the appropriate operating
system command for copying a directory and all contents to a new location.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  On Windows systems, do not attempt to update a database while it is being
backed up in this way. Attempting to update a database during an offline
backup will generate a java.io.IOException. Using online backups prevents
this from occurring.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For large systems, shutting down the database might not be convenient.
To back up a database without having to shut it down, you can use an online backup.</div></div></div><div><a name="N16A6C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup63476"></a><div></div>Online backups</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use online backups to back up a database while it is running, without
blocking transactions.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can perform online backups by using several types of backup procedures
or by using operating systems commands with the freeze and unfreeze system
procedures.</div></div><div><a name="N16AEA"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup01"></a><div></div>Using the backup procedure to perform an online backup: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure to perform an
online backup of a database to a specified location.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure takes a string argument
that represents the location in which to back up the database. Typically,
you provide the full path to the backup directory. (Relative paths are interpreted
as relative to the current directory, not to the derby.system.home directory.)</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, to specify a backup location of <span style="font-family: Courier;">c:/mybackups/2005-06-01</span> for
a database that is currently open, use the following statement (forward slashes
are used as path separators in SQL commands):</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE('c:/mybackups/2005-06-01')</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure puts the database
into a state in which it can be safely copied. The procedure then copies the
entire original database directory (including data files, online transaction log
files, and jar files) to the specified backup directory. Files that are not
within the original database directory (for example, <span style="font-style: italic;">derby.properties</span>)
are <span style="font-style: italic;">not</span> copied. With the exception of a few cases mentioned in 
<span style="color: blue;"><a href="#hubbkupunlogged">Unlogged Operations</a></span>,
the procedure does not block concurrent transactions at any time.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to back up a database to a directory with
a name that reflects the current date:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">public static void backUpDatabase(Connection conn)throws SQLException
{
<span style="font-weight: bold;">// Get today's date as a string:</span>
java.text.SimpleDateFormat todaysDate = 
   new java.text.SimpleDateFormat("yyyy-MM-dd");
String backupdirectory = "c:/mybackups/" +
   todaysDate.format((java.util.Calendar.getInstance()).getTime());

CallableStatement cs = conn.prepareCall("CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE(?)"); 
cs.setString(1, backupdirectory);
cs.execute(); 
cs.close();
System.out.println("backed up database to "+backupdirectory);
}</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a database that was backed up on 2005-06-01, the previous commands
copy the current database to a directory of the same name in <span style="font-style: italic;">c:/mybackups/2005-06-01</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Uncommitted transactions do not appear in the backed-up database.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Do not back up different databases with the same name to the same backup
directory. If a database of the same name already exists in the backup directory,
it is assumed to be an older version and is overwritten.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16B67"></a><span></span><div style="font-weight: bold;">Unlogged Operations</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For some operations, Derby does not log because it can keep the database
consistent without logging the data.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure will issue an error if there
are any unlogged operations in the same transaction as the backup procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If any unlogged operations are in progress in other transactions in the
system when the backup starts, this procedure will block until those transactions
are complete before performing the backup.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Derby automatically converts unlogged operations to logged mode if they
are started while the backup is in progress (except operations that maintain
application jar files in the database). Procedures to install, replace, and
remove jar files in a database are blocked while the backup is in progress.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you do not want backup to block until unlogged operations in other transactions
are complete, use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE_NOWAIT procedure. 
This procedure issues an error immediately at the start of the backup if there
are any transactions in progress with unlogged operations, instead of waiting
for those transactions to complete.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Unlogged operations include:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Index creation.
<div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Only CREATE INDEX is logged, not all the data inserts into the
index. The reason inserts into the index are not logged is:
if there is a failure , it will just drop the index.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
If you create an index when the backup is in progress, it will be
slower because it has to be logged.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
Foreign Keys , Primary Keys create backing indexes. Adding those keys
to an existing table with data will also run slower.
</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Import to an empty table or replacing all the data in a table.
<div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
In this case also, data inserts into table are not logged. Internally,
Derby creates a new table for the import and changes the catalogs to
point to the new table and drops the original table when import
completes.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
If you perform such an import operation when backup is in progress ,
it will be slower because data is logged.
</div></div></td></tr></table></div></div></div></div></div><div><a name="N16BE2"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup75469"></a><div></div>Using operating system commands with the freeze and unfreeze system
procedures to perform an online backup: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Typically, these procedures are used to speed up the copy operation involved
in an online backup. In this scenario, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not perform the copy operation for you. You use the SYSCS_UTIL.SYSCS_FREEZE_DATABASE
procedure to lock the database, and then you explicitly copy the database
directory by using operating system commands. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, because the UNIX tar command uses operating system file-copying
routines, and the SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure uses java I/O
calls with additional internal synchronization that allow updates during the
backup, the tar command might provide faster backups than the SYSCS_UTIL.SYSCS_BACKUP_DATABASE
procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use operating system commands for online database backups, call the
SYSCS_UTIL.SYSCS_FREEZE_DATABASE system procedure. The SYSCS_UTIL.SYSCS_FREEZE_DATABASE
system procedure puts the database into a state in which it can be safely
copied. After the database has been copied, use the SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE
system procedure to continue working with the database. Only after SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE
has been specified can transactions once again write to the database. Read
operations can proceed while the database is "frozen."</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  To ensure a consistent backup of the database, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> might
block applications that attempt to write to a frozen database until the backup
is completed and the SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE system procedure is
called.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example demonstrates how the freeze and unfreeze procedures
are used to surround an operating system copy command:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">public static void backUpDatabaseWithFreeze(Connection conn)
	throws SQLException
{
Statement s = conn.createStatement();
s.executeUpdate(
    "CALL SYSCS_UTIL.SYSCS_FREEZE_DATABASE()");
<span style="font-weight: bold;">//copy the database directory during this interval</span>
s.executeUpdate(
    "CALL SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE()");
s.close();
}</div></pre></div></div></div><div><a name="N16C5D"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup67525"></a><div></div>When the log is in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Read <span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span> to find out about
the default location of the database log.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you put the database log in a non-default location prior to backing
up the database, be aware of the following requirements:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>If you are using an operating system command to back up the database,
you must explicitly copy the log file as well, as shown in the following example:
  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">xcopy d:\mydatabases\sample c:\mybackups\2005-06-01\sample /s /i
xcopy h:\janet\tourslog\log c:\mybackups\2005-06-01\sample\log /s /i</div></pre></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are not using Windows, substitute the appropriate operating system
command for copying a directory and all of its contents to a new location.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Edit the <span style="font-style: italic;">logDevice</span> entry in <span style="font-style: italic;">service.properties</span> of the database
backup so that it points to the correct location for the log. In the previous
example, the log was moved to the default location for a log, so you can remove
the logDevice entry entirely, or leave the logDevice entry as is and wait
until the database is restored to edit the entry.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span> for information about
putting the log in a non-default location.</div></div></div><div><a name="N16CF9"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup21105"></a><div></div>Backing up encrypted databases</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">When you back up an encrypted database, both the backup and the log files
remain encrypted.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To restore an encrypted database, you must know the boot password.</div></div></div></div><div><a name="N16D74"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminhubbkup44"></a><div></div>Restoring a database from a backup copy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To restore a database by using a full backup from a specified location,
specify the <span style="font-family: Courier;">restoreFrom=<span style="font-style: italic;">Path</span></span> attribute in the boot
time connection URL.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16D8D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a database with the same name exists in the derby.system.home
location, the system will delete the database, copy it from the backup location,
and then restart it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The log files are copied to the same location they
were in when the backup was taken. You can use the <span style="font-family: Courier;">logDevice</span> attribute
in conjunction with the <span style="font-family: Courier;">restoreFrom=<span style="font-style: italic;">Path</span></span> attribute
to store logs in a different location.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16DAC"></a><span></span> For example, to restore the sample database by using a backup copy
in <span style="font-family: Courier;">c:\mybackups\sample</span>, the connection URL should be: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:sample;restoreFrom=c:\mybackups\sample</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "restoreFrom=path attribute" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div></div></div><div><a name="N16E11"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmincrtdbbkup"></a><div></div>Creating a database from a backup copy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To create a database from a full backup copy at a specified location,
specify the <span style="font-family: Courier;">createFrom=<span style="font-style: italic;">Path</span></span> attribute in the boot
time connection URL.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16E3B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If there is already a database with the same name in derby.system.home,
an error will occur and the existing database will be left intact. If there
is not an existing database with the same name in the current derby.system.home
location, the system will copy the whole database from the backup location
to derby.system.home and start it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The log files are also copied to
the default location. You can use the <span style="font-family: Courier;">logDevice</span> attribute
in conjunction with the <span style="font-family: Courier;">createFrom=Path</span> attribute to store
logs in a different location. With the <span style="font-family: Courier;">createFrom=Path</span> attribute,
you do not need to copy the individual log files to the log directory.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16E5B"></a><span></span>For example, to create the sample database from a backup copy in <span style="font-family: Courier;">c:\mybackups\sample</span>,
the connection URL should be:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:sample;createFrom=c:\mybackups\sample</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "createFrom=path attribute" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div></div></div><div><a name="N16EC0"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminrollforward"></a><div></div>Roll-forward recovery</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> supports
roll-forward recovery to restore a damaged database to the most recent state
before a failure occurred.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> restores a database
from full backup and replays all the transactions after the backup. All the
log files after a backup are required to replay the transactions after the
backup. By default, the database keeps only logs that are required for crash-recovery.
For roll-forward recovery to be successful, all log files must be archived
after a backup. Log files can be archived using the backup function calls
that enable log archiving.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In roll-forward recovery the log archival mode ensures that all old log
files are available. The log files are available only from the time that the
log archival mode is enabled. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> uses the following
information to restore the database: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The backup copy of the database</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The set of archived logs</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The current online active log</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You cannot use roll-forward recovery to restore individual tables. Roll-forward
recovery recovers the entire database.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To restore a database by using roll-forward recovery, you must already
have a backup copy of the database, all the archived logs since the backup
was created, and the active log files. All the log files should be in the
database log directory.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are two types of log files in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>:
active logs and online archived logs.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Active logs</span></div><div style="margin-left: 72pt + 16pt;">Active logs are used during crash recovery to prevent a failure that might
leave a database in an inconsistent state. Roll-forward recovery can also
use the active logs to recover to the end of the log files. Active logs are
located in the database log path directory.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Online archived logs</span></div><div style="margin-left: 72pt + 16pt;">Log files that are stored for roll-forward recovery use when they are
no longer needed for crash recovery. Online archived logs are also kept in
the database log path directory.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Enabling log archival mode</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Online archive logs are available only if the database is enabled for log
archival mode. You can use the following system procedure to enable the database
for log archival mode:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE
(IN BACKUPDIR VARCHAR(32672), IN SMALLINT DELETE_ARCHIVED_LOG_FILES)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The input parameters for the calls in the previous example specify the
location where the backup should be stored and specify whether or not the
database should keep online archived logs for the backup. Existing online
archived log files that were created before this backup will be deleted if
the input parameter value for the <span style="font-style: italic;">deleteOnlineArchivedLogFiles</span> parameter
is non-zero. The log files are deleted only after a successful backup. <div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Make
sure to store the backup database in a safe place when you choose the log
file removal option.</div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE procedure
will issue an error if there are any unlogged operations in the same transaction
as backup procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If any unlogged operations are in progress in other transactions in the
system when the backup starts, this procedure will block until those transactions
are complete before performing the backup. Derby automatically converts unlogged
operations to logged mode if they are started while the backup is in progress
(except operations that maintain application jar files in the database). Procedures
to install, replace, and remove jar files in a database are blocked while
the backup is in progress.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you do not want backup to block until unlogged operations in other transactions
are complete, use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE_NOWAIT
procedure. This procedure issues an error immediately at the start of the
backup if there are any transactions in progress with unlogged operations,
instead of waiting for those transactions to complete.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Disabling log archival mode:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After you enable log archival mode, the database will always have the log
archival mode enabled even if it is subsequently booted or backed up. The
only way to disable the log archive mode is to run the following procedure:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_DISABLE_LOG_ARCHIVE_MODE(IN SMALLINT DELETE_ARCHIVED_LOG_FILES)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This system procedure disables the log archive mode and deletes any existing
online archived log files if the input parameter <span style="font-style: italic;">DELETE_ARCHIVED_LOG_FILES</span> is
non-zero.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Performing roll-forward recovery:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By using the full backup copy, archived logs, and active logs, you can
restore a database to its most recent state by performing roll-forward recovery.
You perform a roll-forward recovery by specifying the connection URL attribute <span style="font-style: italic;">rollForwardRecoveryFrom=path</span> at
boot time. This brings the database to its most recent state by using full
backup copy, archived logs, and active logs. All the log files should be in
the database log path directory.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "rollForwardRecoveryFrom=path attribute"
in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Backing up a database:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">In the following example, a database named wombat is backed up to the d:/backup
directory with log archive mode enabled:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">connect 'jdbc:derby:wombat;create=true';

create table t1(a int not null primary key);
------------------DML/DDL Operations
CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE
('d:/backup', 0);
insert into t1 values(19);
create table t2(a int);
-----------------DML/DDL Operations
-----------------Database Crashed (Media Corruption on data disks)</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Restoring a database using roll-forward recovery:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">In the following example, the database is restored using roll-forward recovery
after a media failure:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">connect 'jdbc:derby:wombat;rollForwardRecoveryFrom=d:/backup/wombat';
select * from t1;
---------------DML/DDL Operations</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After a database is restored from full backup, transactions from the online
archived logs and active logs are replayed.</div></div></div></div><div><a name="N1704A"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminimport16245"></a><div></div>Importing and exporting data</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can import and export large amounts of data between files and
the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database. Instead
of having to use INSERT and SELECT statements, you can use
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> system procedures to
import data directly from files into tables and to export data from tables into
files.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> system
procedures import and export data in delimited data file format.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the export system procedures to write data from a database to one
or more files that are stored outside of the database. You can use a procedure
to export data from a table into a file or export data from a SELECT statement
result into a file.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the import system procedures to import data from a file into a table.
If the target table already contains data, you can replace or append to the
existing data.</div></td></tr></table></div></div><div><a name="N171A5"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimport98264"></a><div></div>Methods for running the import and export procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can run the import and export procedures from within an SQL
statement using <span style="font-family: Courier;">ij</span> or any Java application.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The import and export procedures read and write text files, and if you
use an external file when you import or export data, you can also import and
export blob data. The import procedures do not support read-once streams (live
data feeds), because the procedures read the first line of the file to determine
the number of columns, then read the file again to import the data.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  The import and export procedures are server-side utilities that exhibit
different behavior in client/server mode. Typically, you use these procedures
to import data into and export data from a locally running
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database. However, you
can use the import and export procedures when
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is running in a server
framework if you specify import and export files that are accessible to the
server.</div></div></div><div><a name="N172B1"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimport27052"></a><div></div>Bulk import and export requirements and considerations</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">There are requirements and limitations that you must consider before
you use the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> import
and export procedures.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Database transactions</span></div><div style="margin-left: 72pt + 16pt;">You should issue either a COMMIT or ROLLBACK statement to complete all
transactions and release all table-level locks before you invoke an import
or export procedure. <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
issues a COMMIT or a ROLLBACK statement after each import and export procedure
is run.<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Imports are transactional. If an error occurs during bulk import,
all changes are rolled back.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Database connections</span></div><div style="margin-left: 72pt + 16pt;">To invoke a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> import
or export procedure, you must be connected to the database into which the
data is imported or from which the data is exported. Other user applications
that access the table with a separate connection do not need to disconnect.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Classpath</span></div><div style="margin-left: 72pt + 16pt;">You must have the <span style="font-family: Courier;">derbytools.jar</span> file in your classpath
before you can use the import or export procedures from
<span style="font-family: Courier;">ij</span>.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">The table must exist</span></div><div style="margin-left: 72pt + 16pt;">To import data into a table, the table must already exist in
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>. The table does not
have to be empty. If the table is not empty, bulk import performs single row
inserts, which result in slower performance.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Create indexes, keys, and unique constraints before you import</span></div><div style="margin-left: 72pt + 16pt;">To avoid a separate step, create the indexes, keys (primary and foreign),
and unique constraints on tables before you import data. However, if your
memory and disk space resources are limited, you can build the indexes and
primary keys after importing data.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Data types</span></div><div style="margin-left: 72pt + 16pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> implicitly converts
the strings to the data type of the receiving column. If any of the implicit
conversions fail, the whole import is aborted. For example, "3+7" cannot be
converted into an integer. An export that encounters a runtime error stops.
<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  You cannot import or export the XML data type.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Locking during import</span></div><div style="margin-left: 72pt + 16pt;">Import procedures use the same isolation level as the connection in which
they are executed to insert data into tables. During import, the entire table
is exclusively locked irrespective of the isolation level.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Locking during export</span></div><div style="margin-left: 72pt + 16pt;">Export procedures use the same isolation level as the connection in which
they are executed to fetch data from tables.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Import behavior on tables with triggers</span></div><div style="margin-left: 72pt + 16pt;">The import procedures enable INSERT triggers when data is appended to the
table. The REPLACE parameter is not allowed when triggers are enabled on the
table.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Restrictions on the REPLACE parameter</span></div><div style="margin-left: 72pt + 16pt;">If you import data into a table that already contains data, you can either
replace or append to the existing data. You can use the REPLACE parameter
on tables that have dependent tables. The replaced data must maintain
referential integrity; otherwise, the import operation will be rolled back. You
cannot use the REPLACE parameter if the table has triggers enabled.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Restrictions on tables</span></div><div style="margin-left: 72pt + 16pt;">You cannot use import procedures to import data into a system table or a
declared temporary table.</div></div></div></div></div><div><a name="N1748C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimportlobs"></a><div></div>Bulk import and export of large objects</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can import and export large objects (LOBs) using the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> system
procedures.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17506"></a><span></span><div style="font-weight: bold;">Importing and exporting CLOB and BLOB data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">CLOB and BLOB data can be exported to the same file as the rest of the column
data, or the LOB column data can be exported to a separate external file. When
the LOB column data is exported to a separate external file, reference to the
location of the LOB data is placed in the LOB column in the main export
file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Importing and exporting LOB data using a separate external file might be
faster than storing the LOB data in the same file as the rest of the column
data:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The CLOB data does not have to be scanned for the delimiters inside the
data</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The BLOB data does not need to be converted to hexadecimal format</div></td></tr></table></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17527"></a><span></span><div style="font-weight: bold;">Importing and exporting other binary data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When you export columns that contain the data types CHAR FOR BIT DATA,
VARCHAR FOR BIT DATA, and LONG VARCHAR FOR BIT DATA, the column data is always
exported to the main export file. The data is written in hexadecimal format. To
import data into a table that has columns of these data types, the data in the
import file for those columns must be in hexadecimal format.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17535"></a><span></span><div style="font-weight: bold;">Importing LOB data from a file that contains all of the
data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the SYSCS_UTIL.SYSCS_IMPORT_TABLE and
SYSCS_UTIL.SYSCS_IMPORT_DATA procedures to import data into a table that
contains a LOB column. The LOB data must be stored in the same file as the other
column data that you are importing. If you are importing data from a file that
was exported from a non-<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
source, the binary data must be in hexadecimal format.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17549"></a><span></span><div style="font-weight: bold;">Importing LOB data from a separate external file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the SYSCS_UTIL.SYSCS_IMPORT_TABLE_LOBS_FROM_EXTFILE and
SYSCS_UTIL.SYSCS_IMPORT_DATA_LOBS_FROM_EXTFILE procedures to import LOB data
that is stored in a file that is separate from the main import file. These
procedures read the LOB data using the reference that is stored in the main
import file.  If you are importing data from a
non-<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> source, the
references to the LOB data must be in the main import file in the format
<span>lobsFileName.Offset.length/</span>. This is the same method that
the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> export procedures
use to export the LOB data to a separate external file.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17569"></a><span></span><div style="font-weight: bold;">Exporting LOB data to the same file as the other column
data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the SYSCS_UTIL.SYSCS_EXPORT_TABLE and
SYSCS_UTIL.SYSCS_EXPORT_QUERY procedures to write LOB data, along with rest of
the column data, to a single export file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">CLOB column data is treated same as other character data. Character
delimiters are allowed inside the CLOB data. The export procedures write the
delimiter inside the data as a double-delimiter.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">BLOB column data is written to the export file in hexadecimal format. For
each byte of BLOB data, two characters are generated. The first character
represents the high nibble (4 bits) in hexadecimal and the second character
represents the low nibble.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17581"></a><span></span><div style="font-weight: bold;">Exporting LOB data to a separate external file from the other
column data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the SYSCS_UTIL.SYSCS_EXPORT_TABLE_LOBS_TO_EXTFILE and
SYSCS_UTIL.SYSCS_EXPORT_QUERY_LOBS_TO_EXTFILE procedures to write LOB data to a
separate external file. These procedures include the
<span>lobFileName</span> parameter, which specifies the name of the
external file for the LOB data.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When you use these procedures, the location of the LOB data is written to the
main export file. The format of the  reference to the LOB stored in the main
export file is <span>lobsFileName.Offset.length/</span>.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span>Offset</span> is the position in the external file in
bytes</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span>length</span> is the size of the LOB column data in
bytes</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a LOB column value is NULL, length is written as -1. No data conversion
is performed when you export LOB data to an external file. BLOB data is written
in binary format, and CLOB data is written using the codeset that you
specify.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#radminimport91458">Examples of bulk import and export</a></span> for
examples using each of the import and export procedures.</div></div></div></div><div><a name="N17671"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimportdefaultformat"></a><div></div>File format for input and output</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">There are specific requirements for the format of the input and
output files when you import and export data.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The default file format is a delimited text file with the following
characteristics:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Rows are separated by a newline</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Fields are separated by a comma (<span style="font-family: Courier;">,</span>)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Character-based fields are delimited with double quotes
(<span style="font-family: Courier;">"</span>)</div></td></tr></table></div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Restriction: </span>  Before you perform import or export operations, you
must ensure that the chosen delimiter character is not contained in the data
to be imported or exported. If you chose a delimiter character that is part
of the data to be imported or exported, unexpected errors might occur. The
following restrictions apply to column and character delimiters:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Delimiters are mutually exclusive</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>A delimiter cannot be a line-feed character, a carriage return, or a blank
space</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The default decimal point (<span style="font-family: Courier;">.</span>) cannot be a character
delimiter</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Delimiters cannot be hexadecimal characters (0-9, a-f, A-F).</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The record delimiter is assumed to be a newline character. The record
delimiter should not be used as any other delimiter.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Character delimiters are permitted with the character-based fields (CHAR,
VARCHAR, and LONG VARCHAR) of a file during import. Any pair of character
delimiters found between the enclosing character delimiters is imported into
the database. For example, suppose that you have the following character string:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">"What a ""great"" day!"</div></pre>
The preceding character string gets imported into the database as:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">What a "great" day!</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">During export, the rule applies in reverse. For example, suppose you have
the following character string:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">"The boot has a 3" heel."</div></pre>
The preceding character string gets exported to a file as:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">"The boot has a 3""heel."</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following example file shows four rows and four columns in the default
file format:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">1,abc,22,def
22,,,"a is a zero-length string, b is null"
13,"hello",454,"world"
4,b and c are both null,,</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The export procedure outputs the following values:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">1,"abc",22,"def"
22,,,"a is a zero-length string, b is null"
13,"hello",454,"world"
4,"b and c are both null",,</div></pre></div></div></div><div><a name="N177CC"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminimporting"></a><div></div>Importing data using the built-in procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> import procedures to
import all of the data from a table or query, or to import LOB data separately
from the other data.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17805"></a><span></span></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Use the following table to choose the correct procedure for the type
of import that you want to perform. For examples of these procedures, see
<span style="color: blue;"><a href="#radminimport91458">Examples of bulk import and export</a></span>.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div style="font-weight: bold;"><span style="color: red;">Table 10. </span>Using the built-in import procedures</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type of Import</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Procedure to Use</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To import all the data to a table, where the import file
contains the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_IMPORT_TABLE 
 (IN <span style="color: blue;"><a href="#radminimportschemaname">SCHEMANAME</a></span> VARCHAR(128), 
  IN <span style="color: blue;"><a href="#radminimport27122">TABLENAME</a></span> VARCHAR(128), 
  IN <span style="color: blue;"><a href="#radminimportfilename">FILENAME</a></span> VARCHAR(32672), 
  IN <span style="color: blue;"><a href="#radminimportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1), 
  IN <span style="color: blue;"><a href="#radminimportcharacterdelimiter">CHARACTERDELIMITER</a></span>  CHAR(1), 
  IN <span style="color: blue;"><a href="#radminimportcodesetarg">CODESET</a></span> VARCHAR(128), 
  IN <span style="color: blue;"><a href="#radminimportreplace">REPLACE</a></span> SMALLINT)</div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To import the data to a table, where the LOB data is
stored in a separate file and the main import file contains all of the other
data with a reference to the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_IMPORT_TABLE_LOBS_FROM_EXTFILE
 (IN <span style="color: blue;"><a href="#radminimportschemaname">SCHEMANAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimport27122">TABLENAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcodesetarg">CODESET</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportreplace">REPLACE</a></span> SMALLINT)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The import utility looks in the main import file for a reference to the
location of the LOB data. The format of the reference to the LOB stored in the
main import file must be <span style="font-family: Courier;">lobsFileName.Offset.length/</span>.</div></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To import data from a file to a subset of columns in a
table, where the import file contains the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_IMPORT_DATA
 (IN <span style="color: blue;"><a href="#radminimportschemaname">SCHEMANAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimport27122">TABLENAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportinsertcolumns">INSERTCOLUMNS</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportcolumnindexes">COLUMNINDEXES</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcodesetarg">CODESET</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportreplace">REPLACE</a></span> SMALLINT)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You must specify the INSERTCOLUMNS parameter on the table into which data
will be imported. You must specify the COLUMNINDEXES parameter to import data
fields from a file to column in a table.</div></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To import data to a subset of columns in a table, where
the LOB data is stored in a separate file and the main import file contains all
of the other data with a reference to the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_IMPORT_DATA_LOBS_FROM_EXTFILE
 (IN <span style="color: blue;"><a href="#radminimportschemaname">SCHEMANAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimport27122">TABLENAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportinsertcolumns">INSERTCOLUMNS</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportcolumnindexes">COLUMNINDEXES</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminimportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminimportcodesetarg">CODESET</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminimportreplace">REPLACE</a></span> SMALLINT)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The import utility looks in the main import file for a reference to the
location of the LOB data. The format of the reference to the LOB stored in the
main import file must be <span style="font-family: Courier;">lobsFileName.Offset.length/</span>.</div></div></td></tr></tbody></table></div></div></div></td></tr></table></div></div><div><a name="N17A87"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminimport64241"></a><div></div>Parameters for the import procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> import
procedures use specific parameters.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17AC5"></a><span></span><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">SCHEMANAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the schema of the table. You can specify a NULL value to use
the default schema name. The <span>SCHEMANAME</span> parameter takes
an input argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">TABLENAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the name of the table into which the data is to be imported.
This table cannot be a system table or a declared temporary table. The string
must exactly match the case of the table name. Specifying a NULL value results
in an error. The <span>TABLENAME</span> parameter takes an input
argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">INSERTCOLUMNS</span></div><div style="margin-left: 72pt + 16pt;">Specifies the comma-separated column names of the table into which the
data will be imported. You can specify a NULL value to import into all columns
of the table. The <span>INSERTCOLUMNS</span> parameter takes an input
argument that is a VARCHAR(32672) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">COLUMNINDEXES</span></div><div style="margin-left: 72pt + 16pt;">Specifies the comma-separated column indexes (numbered from one) of the
input data fields that will be imported. You can specify a NULL value to use all
input data fields in the file. The <span>COLUMNINDEXES</span> parameter
takes an input argument that is a VARCHAR(32672) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">FILENAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the name of the file that contains the data to be imported.
If the path is omitted, the current working directory is used. The specified
location of the file should refer to the server side location if you are using
the Network Server. Specifying a NULL value results in an error. The
<span>FILENAME</span> parameter takes an input argument that is a
VARCHAR(32672) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">COLUMNDELIMITER</span></div><div style="margin-left: 72pt + 16pt;">Specifies a column delimiter. The specified character is used in place
of a comma to signify the end of a column. You can specify a NULL value to
use the default value of a comma. The <span>COLUMNDELIMITER</span>
parameter takes an input argument that is a CHAR(1) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CHARACTERDELIMITER</span></div><div style="margin-left: 72pt + 16pt;">Specifies a character delimiter. The specified character is used in place
of double quotation marks to enclose a character string. You can specify a
NULL value to use the default value of a double quotation mark. The
<span>CHARACTERDELIMITER</span> parameter takes an input argument that
is a CHAR(1) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CODESET</span></div><div style="margin-left: 72pt + 16pt;">Specifies the code set of the data in the input file. The code set name
should be one of the Java supported character encoding sets. Data is converted
from the specified code set to the database code set (UTF-8). You can specify
a NULL value to interpret the data file in the same code set as the JVM in
which it is being executed. The <span>CODESET</span> parameter takes
an input argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">REPLACE</span></div><div style="margin-left: 72pt + 16pt;">A non-zero value for the replace parameter will import in REPLACE mode,
while a zero value will import in INSERT mode. REPLACE mode deletes all existing
data from the table by truncating the table and inserts the imported data.
The table definition and the index definitions are not changed. You can import
with REPLACE mode only if the table already exists. INSERT mode adds the
imported data to the table without changing the existing table data. Specifying
a NULL value results in an error. The <span>REPLACE</span> parameter
takes an input argument that is a SMALLINT data type.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you create a schema, table, or column name as a non-delimited identifier,
you must pass the name to the import procedure using all uppercase characters.
If you created a schema, table, or column name as a delimited identifier, you
must pass the name to the import procedure using the same case that was used
when it was created.</div></div></div></div><div><a name="N17BBD"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminimportidentitycol"></a><div></div>Import into tables that contain identity columns</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the either the SYSCS_UTIL.SYSCS_IMPORT_DATA procedure
or the SYSCS_UTIL.SYSCS_IMPORT_DATA_LOBS_FROM_EXTFILE procedure to import
data into a table that contains an identity column. The approach that you take
depends on whether the identity column is GENERATED ALWAYS or GENERATED BY
DEFAULT.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17BE1"></a><span></span><div style="font-weight: bold;">Identity columns and the REPLACE parameter</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the <span>REPLACE</span> parameter is used during import, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> resets its internal counter
of the last identity value for a column to the initial value defined for the
identity column.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17BFB"></a><span></span><div style="font-weight: bold;">Identity column is GENERATED ALWAYS</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the identity column is defined as GENERATED ALWAYS, an identity value is
always generated for a table row. When a corresponding row in the input file
already contains a value for the identity column, the row cannot be inserted
into the table and the import operation will fail.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To prevent such failure, the following examples show how to specify
parameters in the SYSCS_UTIL.SYSCS_IMPORT_DATA and
SYSCS_UTIL.SYSCS_IMPORT_DATA_LOBS_FROM_EXTFILE procedures to ignore data for the
identity column from the file, and omit the column name from the insert column
list.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table definition contains an identity column,
<span style="font-family: Courier;">c2</span>, and is used in the examples below:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CREATE TABLE tab1 (c1 CHAR(30), c2 INT GENERATED ALWAYS AS IDENTITY, 
   c3 REAL, c4 CHAR(1))</div></pre><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Suppose that you want to import data into <span style="font-family: Courier;">tab1</span> from a file,
<span style="font-family: Courier;">myfile.del</span>, that does not have identity column information.
The <span style="font-family: Courier;">myfile.del</span> file contains three fields with the following
data:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Robert,45.2,J
Mike,76.9,K
Leo,23.4,I</div></pre>
To import the data, you must explicitly list the column names in the
<span style="font-family: Courier;">tab1</span> table, except for the identity column <span style="font-family: Courier;">c2</span>,
when you call the procedure. For example:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL, 'TAB1', 'C1,C3,C4', 
    null, 'myfile.del',null, null, null, 0)</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Suppose that you want to import data into <span style="font-family: Courier;">tab1</span> from a file,
<span style="font-family: Courier;">empfile.del</span>, that also has identity column information. The
file contains three fields with the following data:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Robert,1,45.2,J
Mike,2,23.4,I
Leo,3,23.4,I</div></pre>
To import the data, you must explicitly specify an insert column list without
the identity column <span style="font-family: Courier;">c2</span> and specify the column indexes without
identity column data when you call the procedure. For example:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL, 'TAB1', 'C1,C3,C4', 
    '1,3,4', 'empfile.del',null, null, null, 0)</div></pre></div></td></tr></table></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17C77"></a><span></span><div style="font-weight: bold;">Identity column is GENERATED BY DEFAULT</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the identity column is defined as GENERATED BY DEFAULT, an identity value
is generated for a table row only if no explicit value is given. This means that
you have several options, depending on the contents of your input file and the
desired outcome of the import processing:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>You may omit the identity column from the insert column list, in which case 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> will generate a new
value for the identity column for each input row. You may use this option
whether or not the input file contains values for the identity column, but note
that if the input file contains values for the identity column, you must also
then omit the identity column from the column indexes when you call the
procedure.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>You may include the identity column in the insert column list, in which case
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> will use the column
values from the input file. Of course, this option is available only if the
input file actually contains values for the identity column.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following table definition contains an identity column,
<span style="font-family: Courier;">c2</span>, and is used in the examples below:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CREATE TABLE tab1 (c1 CHAR(30),
   c2 INT GENERATED BY DEFAULT AS IDENTITY, 
   c3 REAL, c4 CHAR(1))</div></pre><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Suppose that you want to import data into <span style="font-family: Courier;">tab1</span> from a
file, <span style="font-family: Courier;">myfile.del</span>, that does not have identity column
information. The <span style="font-family: Courier;">myfile.del</span> file contains three fields with the
following data: 
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Robert,45.2,J
Mike,76.9,K
Leo,23.4,I</div></pre>
To import the data, you must explicitly list the column names in the
<span style="font-family: Courier;">tab1</span> table, except for the identity column <span style="font-family: Courier;">c2</span>,
when you call the procedure. For example:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL, 'TAB1', 'C1,C3,C4', 
    null, 'myfile.del',null, null, null, 0)</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Suppose that you want to import data into <span style="font-family: Courier;">tab1</span> from a file,
<span style="font-family: Courier;">empfile.del</span>, that also has identity column information. The
file contains three fields with the following data:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Robert,1,45.2,J
Mike,2,23.4,I
Leo,3,23.4,I</div></pre> 
In this case, suppose that you wish to use the existing identity column values
from the input file. To import the data, you may simply pass
<span style="font-family: Courier;">null</span> for the insert column list and column indexes parameters
when you call the procedure. For example:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL, 'TAB1', NULL, 
    NULL, 'empfile.del',null, null, null, 0)</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Suppose (again) that you want to import data into <span style="font-family: Courier;">tab1</span>
from a file, <span style="font-family: Courier;">empfile.del</span>, that also has identity column
information, but in this case, suppose that you do <span style="font-weight: bold;">not</span> wish to use the
identity column values from the input file, but would prefer to allow
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> to generate new
identity column values instead. In this case, to import the data, you must
specify an insert column list without the identity column <span style="font-family: Courier;">c2</span>
and specify the column indexes without identity column data when you call the
procedure. For example:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL, 'TAB1', 'C1,C3,C4', 
    '1,3,4', 'empfile.del',null, null, null, 0)</div></pre></div></td></tr></table></div></div></div></div></div><div><a name="N17D56"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminexporting"></a><div></div>Exporting data using the built-in procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> export procedures to
export all of the data from table or query, or to export LOB data separately
from the other data.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17D8F"></a><span></span></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Use the following table to choose the correct procedure for the type
of export that you want to perform. For examples of these procedures, see
<span style="color: blue;"><a href="#radminimport91458">Examples of bulk import and export</a></span>.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div style="font-weight: bold;"><span style="color: red;">Table 11. </span>Using the built-in export procedures</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type of Export</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Procedure to Use</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To export all the data from a table to a single export
file, including the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_EXPORT_TABLE
 (IN <span style="color: blue;"><a href="#radminexportschemaname">SCHEMANAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexporttablename">TABLENAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcodeset">CODESET</a></span> VARCHAR(128))</div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To export all the data from a table, and place the LOB
data into a separate export file</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_EXPORT_TABLE_LOBS_TO_EXTFILE
 (IN <span style="color: blue;"><a href="#radminexportschemaname">SCHEMANAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexporttablename">TABLENAME</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcodeset">CODESET</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexportlobsfilename">LOBSFILNAME</a></span> VARCHAR(32672))</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A reference to the location of the LOB data is placed in the LOB column in
the main export file.</div></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To export the result of a SELECT statement to a single
file, including the LOB data</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_EXPORT_QUERY
 (IN <span style="color: blue;"><a href="#radminexportselectstatement">SELECTSTATEMENT</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcodeset">CODESET</a></span> VARCHAR(128))</div></pre></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>To export the result of a SELECT statement to a main
export file, and place the LOB data into a separate export file</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_EXPORT_QUERY_LOBS_TO_EXTFILE
 (IN <span style="color: blue;"><a href="#radminexportselectstatement">SELECTSTATEMENT</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportfilename">FILENAME</a></span> VARCHAR(32672),
  IN <span style="color: blue;"><a href="#radminexportcolumndelimiter">COLUMNDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcharacterdelimiter">CHARACTERDELIMITER</a></span> CHAR(1),
  IN <span style="color: blue;"><a href="#radminexportcodeset">CODESET</a></span> VARCHAR(128),
  IN <span style="color: blue;"><a href="#radminexportlobsfilename">LOBSFILENAME</a></span> VARCHAR(32672))</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A reference to the LOB data is written to the main export file.</div></div></td></tr></tbody></table></div></div></div></td></tr></table></div></div><div><a name="N17FB7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminexportarguments"></a><div></div>Parameters for the export procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> export
procedures use specific parameters.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N17FF5"></a><span></span><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">SCHEMANAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the schema of the table. You can specify a NULL value to use the
default schema name. The <span>SCHEMANAME</span> parameter takes an
input argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">SELECTSTATEMENT</span></div><div style="margin-left: 72pt + 16pt;">Specifies the SELECT statement query that returns the data to be exported.
Specifying a NULL value will result in an error. The
<span>SELECTSTATEMENT</span> parameter takes an input argument that is
a VARCHAR(32672) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">TABLENAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the table name of the table or view from which the data is to
be exported. This table cannot be a system table or a declared temporary table.
The string must exactly match the case of the table name. Specifying a NULL
value results in an error. The <span>TABLENAME</span> parameter takes
an input argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">FILENAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the file to which the data is to be exported. If the path is
omitted, the current working directory is used. If the name of a file that
already exists is specified, the export utility overwrites the contents of the
file; it does not append the information. The specified location of the file
should refer to the server-side location if you are using the Network Server.
Specifying a NULL value results in an error. The <span>FILENAME</span>
parameter takes an input argument that is a VARCHAR(32672) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">COLUMNDELIMITER</span></div><div style="margin-left: 72pt + 16pt;">Specifies a column delimiter. The specified character is used in place of a
comma to signify the end of a column. You can specify a NULL value to use the
default value of a comma. The <span>COLUMNDELIMITER</span> parameter
must be a CHAR(1) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CHARACTERDELIMITER</span></div><div style="margin-left: 72pt + 16pt;">Specifies a character delimiter. The specified character is used in place of
double quotation marks to enclose a character string. You can specify a NULL
value to use the default value of a double quotation mark. The
<span>CHARACTERDELIMITER</span> parameter takes an input argument that
is a CHAR(1) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CODESET</span></div><div style="margin-left: 72pt + 16pt;">Specifies the code set of the data in the export file. The code set name
should be one of the Java supported character encoding sets.  Data is converted
from the database code page to the specified code page before writing to the
file. You can specify a NULL value to write the data in the same code page
as the JVM in which it is being executed. The <span>CODESET</span>
parameter takes an input argument that is a VARCHAR(128) data type.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">LOBSFILENAME</span></div><div style="margin-left: 72pt + 16pt;">Specifies the file that the large object data is exported to. If the path is
omitted, the LOB file is created in the same directory as the main export file.
If you specify the name of an existing file, the export utility overwrites the
contents of the file. The data is not appended to the file. If you are using the
Network Server, the file should be in a server-side location. Specifying a NULL
value results in an error. The <span>LOBSFILENAME</span> parameter takes
an input argument that is a VARCHAR(32672) data type.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you create a schema, table, or column name as a non-delimited identifier,
you must pass the name to the export procedure using all uppercase characters.
If you created a schema or table name as a delimited identifier, you must pass
the name to the export procedure using the same case that was used when it was
created.</div></div></div></div></div><div><a name="N180D8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminimport91458"></a><div></div>Examples of bulk import and export</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">All of the examples in this section are run using the
<span style="font-family: Courier;">ij</span> utility.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1812A"></a><span></span><div style="font-weight: bold;">Example: Importing all data from a file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to import data into the STAFF table in a
sample database from the <span style="font-family: Courier;">myfile.del</span> file. The data will be
appended to the existing data in the table.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE( 
    null,'STAFF','myfile.del',null,null,null,0);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18144"></a><span></span><div style="font-weight: bold;">Example: Importing all data from a delimited file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to import data into the STAFF table in a
sample database from a delimited data file, <span style="font-family: Courier;">myfile.del</span>. This
example defines the percentage character (<span style="font-family: Courier;">%</span>) as the string
delimiter, and a semicolon as the column delimiter. The data will be appended to
the existing data in the table.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(
    null,'STAFF','c:\output\myfile.del',';','%',null,0);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18164"></a><span></span><div style="font-weight: bold;">Example: Importing all data from a table, using a separate
import file for the LOB data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to import data into the STAFF table in a
sample database from a delimited data file, <span style="font-family: Courier;">staff.del</span>. The
import file <span style="font-family: Courier;">staff.del</span> is the main import file and contains
references that point to a separate file which contains the LOB data. This
example specifies a comma as the column delimiter. The data will be appended to
the existing data in the table.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE_LOBS_FROM_EXTFILE(
    null,'STAFF','c:\data\staff.del',',','"','UTF-8',0);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18184"></a><span></span><div style="font-weight: bold;">Example: Importing data into specific columns, using a separate
import file for the LOB data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to import data into several columns of the
STAFF table. The STAFF table includes a LOB column in a sample database. The
import file, <span style="font-family: Courier;">staff.del</span>, is a delimited data file. The
<span style="font-family: Courier;">staff.del</span> file contains references that point to a separate
file which contains the LOB data. The data in the import file is formatted using
double quotation marks (<span style="font-family: Courier;">"</span>) as the string delimiter and a comma
(<span style="font-family: Courier;">,</span>) as the  column delimiter. The data will be appended to the
existing data in the STAFF table.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_DATA_LOBS_FROM_EXTFILE(
    null, 'STAFF', 'NAME,DEPT,SALARY,PICTURE', '2,3,4,6', 
    'c:\data\staff.del', ',','"','UTF-8',  0);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N181B0"></a><span></span><div style="font-weight: bold;">Example: Exporting all data from a table to a single export
file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to export data from the STAFF table in a
sample database to the file <span style="font-family: Courier;">myfile.del</span>.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_TABLE(
    null,'STAFF','myfile.del',null,null,null);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N181CA"></a><span></span><div style="font-weight: bold;">Example: Exporting data from a table to a single delimited
export file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to export data from the STAFF table to a
delimited data file, <span style="font-family: Courier;">myfile.del</span>, with the percentage character
(<span style="font-family: Courier;">%</span>) as the character delimiter, and a semicolon as the column
delimiter from the STAFF table.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_TABLE(
    null,'STAFF','c:\output\myfile.del',';','%',null);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N181EA"></a><span></span><div style="font-weight: bold;">Example: Exporting all data from a table, using a separate
export file for the LOB data</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to export data from the STAFF table in a
sample database to the main file, <span style="font-family: Courier;">staff.del</span>, and the LOB export
file, <span style="font-family: Courier;">pictures.dat</span>.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_TABLE_LOBS_TO_EXTFILE(null,'STAFF',
    'c:\data\staff.del',',','"','UTF-8', 'c:\data\pictures.dat');</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1820A"></a><span></span><div style="font-weight: bold;">Example: Exporting data from a query to a single export
file</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to export employee data in department 20 from
the STAFF table in a sample database to the file
<span style="font-family: Courier;">awards.del</span>.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_QUERY(
    'SELECT * FROM STAFF WHERE dept=20', 
    'c:\output\awards.del',null,null,null);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18224"></a><span></span><div style="font-weight: bold;">Example: Exporting data from a query, using a separate export
file for the LOB data </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to export employee data in department 20 from
the STAFF table in a sample database to the main file,
<span style="font-family: Courier;">staff.del</span>, and the LOB data to the file
<span style="font-family: Courier;">pictures.dat</span>.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_QUERY_LOBS_TO_EXTFILE(
    'SELECT * FROM STAFF WHERE dept=20',
    'c:\data\staff.del', ',' ,'"', 
    'UTF-8','c:\data\pictures.dat');</div></pre></div></div></div><div><a name="N18311"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimportjdbc"></a><div></div>Running import and export procedures from JDBC</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can run import and export procedures from a JDBC
program.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following code fragment shows how you might call the
SYSCS_UTIL.SYSCS_EXPORT_TABLE procedure from a Java program. In this example,
the procedure exports the data in the <span style="font-family: Courier;">staff</span> table in the
default schema to the <span style="font-family: Courier;">staff.dat</span> file. A percentage
(<span style="font-family: Courier;">%</span>) character is used to specify the column delimiter.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">PreparedStatement ps=conn.prepareStatement(
    "CALL SYSCS_UTIL.SYSCS_EXPORT_TABLE (?,?,?,?,?,?)");
    ps.setString(1,null);
    ps.setString(2,"STAFF");
    ps.setString(3,"staff.dat");
    ps.setString(4,"%");
    ps.setString(5,null);
    ps.setString(6,null);
    ps.execute();
</div></pre></div></div><div><a name="N183EE"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminimportnulls"></a><div></div>How the import and export procedures process NULL values</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">In a delimited file, a NULL value is exported as an empty
field.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows the export of a four-column row where the third
column is empty:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">7,95,,Happy Birthday</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The import procedures work the same way; an empty field is imported as
a NULL value.</div></div></div><div><a name="N184D0"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminimportcodeset"></a><div></div>CODESET values for import and export procedures</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Import and export procedures accept arguments to specify codeset
values. You can specify the codeset (character encoding) for import and export
procedures to override the system default.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N184FE"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a table that shows a sample of the character encodings supported
by the Java Development Kit, see "derby.ui.codeset property" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Tools and Utilities Guide</span></span>. To review the complete list
of character encodings, refer to your Java documentation.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18511"></a><span></span><div style="font-weight: bold;">Examples: Specifying the codeset in import and export
procedures</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to specify UTF-8 encoding to export to the
<span style="font-family: Courier;">staff.dat</span> table:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_EXPORT_TABLE(
    NULL,'STAFF','staff.dat',NULL,NULL,'UTF-8')</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to specify UTF-8 encoding to import from the
<span style="font-family: Courier;">staff.dat</span> table:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(
    NULL,'STAFF','staff.dat',NULL,NULL,'UTF-8',0)</div></pre></div></div></div></div><div><a name="N185CE"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminreplication"></a><div></div>Replicating databases</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Replication is an important feature of a robust database management
system. In <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you
start database replication by using connection URL attributes.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The replication capability of
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> has the following
features:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">One master, one slave</span>: A replicated database resides in two locations
and is managed by two different
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instances. One of these
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instances has the
<span style="font-style: italic;">master</span> role for this database, and the other has the <span style="font-style: italic;">slave</span> role.
Typically, the master and slave run on different nodes, but this is not a
requirement. Together, the master and its associated slave represent a
<span style="font-style: italic;">replication pair</span>.
</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">Roll-forward shipped log</span>: Replication is based on shipping the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> transaction log from
the master to the slave, and then rolling forward the operations described in
the log to the slave database.
</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">Asymmetry</span>: Only the master processes transactions. The slave
processes no transactions, not even read operations.
</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">Asynchronicity</span>: Transactions are committed on the master without
waiting for the slave. The shipping of the transaction log to the slave is
performed regularly, and is completely decoupled from the transaction execution
at the master. This may lead to a few lost transactions if the master crashes.
</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">Shared nothing</span>: Apart from the network line, no hardware is assumed to be
shared.
</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-weight: bold;">Replication granularity</span>: The granularity for replication is exactly
one database. However, one
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance may have
different roles for different databases. For example, one
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance may have the
following roles, all at the same time:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The master role for one database D1 replicated to one node</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The slave role for a database D2 replicated from another node</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The normal, non-replicated, role for a database D3</div></td></tr></table></div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Replication builds on
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s ability to recover
from a crash by starting with a backup and rolling forward
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s transaction log
files. The master sends log records to the slave using a network connection. The
slave then writes these log records to its local log and redoes them.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the master fails, the slave completes the recovery by redoing the log that
has not already been processed. The state of the slave after this recovery is
close to the state the master had when it crashed. However, some of the last
transactions performed on the master may not have been sent to the slave and may
therefore not be reflected. When the slave has completed the recovery work, it
is transformed into a normal
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance that is ready
to process transactions. For more details, see
<span style="color: blue;"><a href="#cadminreplicfailover">Forcing a failover</a></span> and
<span style="color: blue;"><a href="#cadminreplicsecurity">Replication and security</a></span>.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Several Derby properties allow you to specify the size of the replication
log buffers and the intervals between log shipments, as well as whether
replication messages are logged. See the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for details.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can perform replication on a database that runs in either embedded mode
or Network Server mode.
</div></div><div><a name="N1877E"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminreplicstartrun"></a><div></div>Starting and running replication</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Each replicated database is replicated from a master to a slave version of
that database. Initially there is no replication; a master database must be
created before it can be replicated. The database may, of course, be empty when
replication starts. On the other hand, replication does not need to be specified
immediately after the database is created; it can be initiated at any time after
the database is created.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Before you start replication, you must shut down the master database and then
copy the database to the slave location. Follow these
steps to start replication:
</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Make sure that the database on the master system is shut down cleanly.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Copy the database to the slave location.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Start slave replication mode on the Derby instance that is acting
as the slave for the database. To start slave replication, use the
<span style="font-style: italic;">startSlave=true</span> attribute and, optionally, the <span style="font-style: italic;">slaveHost=hostname</span>
and <span style="font-style: italic;">slavePort=portValue</span> attributes. For example, for a database named
<span style="font-family: Courier;">wombat</span>, you might use the following connection URL:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
jdbc:derby:wombat;startSlave=true
</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>4. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div>Start master replication mode on the Derby instance that is acting as the
master for the database. To start replication, connect to the database on the
master system using the <span style="font-style: italic;">startMaster=true</span> attribute in conjunction with
the <span style="font-style: italic;">slaveHost=hostname</span> attribute (and, optionally, the
<span style="font-style: italic;">slavePort=portValue</span> attribute). For example, you might use the following
connection URL:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
jdbc:derby:wombat;startMaster=true;slaveHost=myremotesystem
</div></pre>
A successful use of the <span style="font-style: italic;">startMaster=true</span> attribute will also start the
database.
</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for details about these
attributes.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After replication has been started, the slave
is ready to receive logged operations from the master. The master can now
continue to process transactions. From this point on, the master forwards all
logged operations to the slave in chunks. The slave repeats
these operations by applying the contents of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> transaction log, but does
not process any other operations. Attempts to connect to the slave database are
refused. In case of failure, the slave can recover to the state the master was
in at the time the last chunk of the transaction log was sent.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> While replication is running, neither the slave or the master database is
permitted to be shut down. Replication must be stopped before you can shut down
either the slave or the master database. There is one exception to this rule:
if the entire system is shut down, the peer that is shut down notifies the other
replication peer that replication is stopped.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you install jar files on the master system while replication is running,
the same jars are not automatically installed on the slave. But because the
transaction log information sent to the slave system includes the jar file
installation, the slave database has a record of the jar files, even though they
are not actually there. Therefore, you must install the jar files on the former
slave after a failover by calling either <span style="font-family: Courier;">SQLJ.remove_jar</span>
followed by <span style="font-family: Courier;">SQLJ.install_jar</span>, or
<span style="font-family: Courier;">SQLJ.replace_jar</span>. (For information on installing jar files, see
"Loading classes from a database" in the 
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span> and
"System procedures for storing jar files in a database" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.)</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the jar files must be available to clients immediately after a failover,
you must stop replication and then start replication over again from the
beginning, so that the slave database will have the same jar files as the
master.</div></div></div><div><a name="N188AA"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminreplicstop"></a><div></div>Stopping replication</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To stop replication of a database, connect to the master database using the
<span style="font-style: italic;">stopMaster=true</span> connection URL attribute. The master sends the remaining
log records that await shipment, and then sends a stop replication command to
the slave. The slave then writes all logs to disk and shuts down the database.
For example, for a database named <span style="font-family: Courier;">wombat</span>, you might specify the
following connection URL:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
jdbc:derby:wombat;stopMaster=true
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To stop replication on the slave system if the connection to the master is
lost, use the <span style="font-style: italic;">stopSlave=true</span> connection URL attribute.
</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for details about these
attributes.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You cannot resume replication after it has been stopped. You need to start
replication over again from the beginning using the <span style="font-style: italic;">startMaster=true</span>
attribute, as described in
<span style="color: blue;"><a href="#cadminreplicstartrun">Starting and running replication</a></span>.
</div></div></div><div><a name="N1896C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminreplicfailover"></a><div></div>Forcing a failover</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">At any time, you can transform the
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database that has the
slave role into a normal 
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database that can
process transactions. This transformation from being a slave to becoming an
active <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database is
called <span style="font-style: italic;">failover</span>. During failover, the slave applies the parts of the
transaction log that have not yet been processed. It then undoes operations that
belong to uncommitted transactions, resulting in a transaction-consistent state
that includes all transactions whose commit log record has been sent to the
slave.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You perform failover from the master system. To do so, you connect to the
database on the master system using
the <span style="font-style: italic;">failover=true</span> connection URL attribute. For example, for a database
named <span style="font-family: Courier;">wombat</span>, you might specify the following connection URL:
</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
jdbc:derby:wombat;failover=true
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the network connection between the master system and the slave system is
lost, you can perform failover from the slave system.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for details about the
<span style="font-style: italic;">failover=true</span> attribute.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There is no automatic failover or restart of replication after one of the
instances has failed.</div></div></div><div><a name="N18A3D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminreplicsecurity"></a><div></div>Replication and security</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you want to perform replication with the security manager enabled, you
must modify the security policy file on both the master and slave systems to
allow the master-slave network connection. The section to be modified is the
one following this line:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
grant codeBase "${derby.install.url}derby.jar"
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Add the following permission to the policy file on the master system:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
  permission java.net.SocketPermission "<span style="font-style: italic;">slaveHost</span>:<span style="font-style: italic;">slavePort</span>", "connect,resolve";
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Add the following permission to the policy file on the slave system:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
  permission java.net.SocketPermission "<span style="font-style: italic;">slaveHost</span>", "accept,resolve";
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-style: italic;">slaveHost</span> and <span style="font-style: italic;">slavePort</span> are the values you specify for the
<span style="font-style: italic;">slaveHost=hostname</span> and <span style="font-style: italic;">slavePort=portValue</span> attributes, which are
described in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#tadminnetservbasic">Basic Network Server security policy</a></span> for
details on the security policy file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Depending on the security mode <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is running under, the
measures described in the following table are enforced when you specify the
replication-related connection URL attributes.
</div><div><div style="font-weight: bold;"><span style="color: red;">Table 12. </span>Replication behavior with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> security</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Security Mode</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Replication Attribute Requirements</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>No security</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Anyone may specify the replication attributes</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Authentication is turned on</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Normal <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> connection policy: specify
valid <span style="font-style: italic;">user=userName</span> and <span style="font-style: italic;">password=userPassword</span> attributes</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Authorization is turned on</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The <span style="font-style: italic;">user=userName</span> and <span style="font-style: italic;">password=userPassword</span>
attributes must be valid, and the user must be the owner of the replicated
database</div></td></tr></tbody></table></div></div></div><div><a name="N18BB7"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminreplicfailures"></a><div></div>Replication failure handling</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Replication can encounter several failure situations. The following table
lists these situations and describes the actions that
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> takes as a result.
</div><div><div style="font-weight: bold;"><span style="color: red;">Table 13. </span>Replication failure handling</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Failure Situation</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Action Taken</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Master loses connection with slave.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Transactions are allowed to continue processing while the
master tries to reconnect with the slave. Log records generated while the
connection is down are buffered in main memory. If the log buffer reaches its
size limit before the connection can be reestablished, the master replication
functionality is stopped. You can use the property
<span style="font-style: italic;">derby.replication.logBufferSize</span> to configure the size limit of the
buffer; see the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for
details.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Slave loses connection with master.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The slave tries to reestablish the connection with the
master by listening on the specified host and port. It will not give up until it
is explicitly requested to do so by either the <span style="font-style: italic;">failover=true</span> or
<span style="font-style: italic;">stopSlave=true</span> connection URL attribute. If a failover is requested, the
slave applies all received log records and boots the database as described in
<span style="color: blue;"><a href="#cadminreplicfailover">Forcing a failover</a></span>. If the
<span style="font-style: italic;">stopSlave=true</span> attribute is specified, the slave database is shut down
without further actions.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Two different masters of database D try to replicate to
the same slave.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The slave will only accept the connection from the first
master attempting to connect. Note that authentication is required to start
both the slave and the master, as described in 
<span style="color: blue;"><a href="#cadminreplicsecurity">Replication and security</a></span>.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The master and slave
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instances are not at
the same <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> version.
</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>An exception is raised and replication does not start.
</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The master
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance crashes, then
restarts.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Replication must be restarted, as described in
<span style="color: blue;"><a href="#cadminreplicstartrun">Starting and running replication</a></span>.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The master
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance is not able to
send log data to the slave at the same pace as the log is generated. The main
memory log buffer gradually fills up and eventually becomes full.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The master notices that the main memory log buffer is
filling up. It first tries to increase the speed of the log shipment to keep
the amount of log in the buffer below the maximum. If that is not enough to
keep the buffer from getting full, the response time of transactions may
increase for as long as log shipment has trouble keeping up with the amount of
generated log records. You can use properties to tune both the log buffer size
and the minimum and maximum interval between consecutive log shipments. See
the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for details.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The slave
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance crashes.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The master sees this as a lost connection to the slave.
The master tries to reestablish the connection until the replication log buffer
is full. Replication is then stopped on the master. Replication must be
restarted, as described in
<span style="color: blue;"><a href="#cadminreplicstartrun">Starting and running replication</a></span>.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>An unexpected failure is encountered.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Replication is stopped. The other
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> instance of the
replication pair is notified of the decision if the network connection is still
alive.</div></td></tr></tbody></table></div></div></div></div><div><a name="N18D67"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminlog98"></a><div></div>Logging on a separate device</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can improve the performance of update-intensive,
large databases by putting a database's log on a separate device, which
reduces I/O contention.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the transaction log is in the <span style="font-style: italic;">log</span> subdirectory
of the database directory. Use either of the following methods to store this <span style="font-style: italic;">log</span> subdirectory in another location:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify the non-default location by using the <span style="font-style: italic;">logDevice=logDirectoryPath</span> attribute on the database connection URL when you create the database.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>If the database is already created, move the log manually and update the <span style="font-style: italic;">service.properties</span> file.</div></td></tr></table></div></div><div><a name="N18E6E"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminlog800206"></a><div></div>Using the logDevice=logDirectoryPath attribute</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To specify a non-default location for the log directory, set
the <span style="font-family: Courier;">logDevice=<span style="font-style: italic;">logDirectoryPath</span></span> attribute on the database connection URL when
you create the database.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18EA2"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This attribute is meaningful only when you are creating
a database. You can specify <span style="font-family: Courier;">logDevice=<span style="font-style: italic;">logDirectoryPath</span></span> as either an absolute
path or as a path that is relative to the directory where the JVM is executed.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Setting <span style="font-family: Courier;">logDevice=<span style="font-style: italic;">logDirectoryPath</span></span> on
the database connection URL adds an entry to the <span style="font-style: italic;">service.properties</span> file.
If you ever move the log manually, you will need to alter the entry in <span style="font-style: italic;">service.properties</span>.
If you move the log back to the default location, remove the <span style="font-style: italic;">logDevice</span> entry
from the <span style="font-style: italic;">service.properties</span> file.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18EDE"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the log location for an existing database, you can retrieve
the <span style="font-family: Courier;">logDevice=<span style="font-style: italic;">logDirectoryPath</span></span> attribute as a database property by using the
following statement:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_GET_DATABASE_PROPERTY('logDevice')</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see "logDevice=logDirectoryPath attribute" in the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div></div></div></div><div><a name="N18F4E"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminlog800241"></a><div></div>Example of creating a log in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18F5B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following database connection URL creates a database in the
directory <span style="font-family: Courier;">d:/mydatabases</span>, but puts the database log directory
in <span style="font-family: Courier;">h:/janets/tourslog</span>:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18F70"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:d:/mydatabases/toursDB;
    create=true;logDevice=h:/janets/tourslog</div></pre></div></div></div><div><a name="N18FC0"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminlog800279"></a><div></div>Example of moving a log manually</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18FCD"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you want to move the log to <span style="font-family: Courier;">g:/bigdisk/tourslog</span>, move the log with operating system commands:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18FDC"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">move h:\janets\tourslog\log\*.* g:\bigdisk\tourslog\log</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18FEA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Then, alter the <span style="font-style: italic;">logDevice </span>entry in <span style="font-style: italic;">service.properties</span> to read as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N18FFF"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">logDevice=g:/bigdisk/toursLog</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N19009"></a><span></span><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  You can use either a single forward slash or double back slashes
for a path separator.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N19012"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you later want to move the log back to its default location (in this
case, <span style="font-family: Courier;">d:\mydatabases\toursDB\log</span>), move
the log manually as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N19021"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">move g:\bigdisk\tourslog\log\*.* d:\mydatabases\toursDB\log</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1902F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Then, delete the <span style="font-style: italic;">logDevice </span>entry from <span style="font-style: italic;">service.properties.</span></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N19043"></a><span></span><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  This example uses commands that are specific to the Windows NT operating
system. Use commands appropriate to your operating system to copy a directory
and all of its contents to a new location.</div></div></div></div><div><a name="N19092"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminlog800315"></a><div></div>Issues for logging in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When the log is not in the default location, backing up and restoring a
database can require extra steps. See <span style="color: blue;"><a href="#cadminhubbkup98797">Backing up and restoring databases</a></span> for
details.</div></div></div></div><div><a name="N190F2"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminlockvti42553"></a><div></div>Obtaining locking information</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides a tool
to monitor and display locking information. This tool can help you create
applications that minimize deadlock. It can also help you locate the cause
of deadlock when it does occur.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To diagnose locking problems, constantly monitor locking traffic by logging
all deadlocks by using the derby.locks.monitor property.</div></div><div><a name="N191A8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminlockvti83889"></a><div></div>Monitoring deadlocks</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="font-family: Courier;">derby.stream.error.logSeverityLevel</span> property determines the
level of error that you are informed about.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, <span style="font-family: Courier;">derby.stream.error.logSeverityLevel</span> is
set to 40000. If <span style="font-family: Courier;">derby.stream.error.logSeverityLevel</span> is
set to display transaction-level errors (that is, if it is set to a value
less than 40000), deadlock errors are logged to the <span style="font-family: Courier;">derby.log</span> file.
If it is set to a value of 40000 or higher, deadlock errors are not logged
to the <span style="font-family: Courier;">derby.log</span> file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">derby.locks.monitor</span> property ensures that deadlock errors are
logged regardless of the value of <span style="font-family: Courier;">derby.stream.error.logSeverityLevel</span>.
When <span style="font-family: Courier;">derby.locks.monitor</span> is set to true, all
locks that are involved in deadlocks are written to <span style="font-family: Courier;">derby.log</span> along with a unique
number that identifies the lock.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To see a thread's stack trace when a lock is requested, set <span style="font-family: Courier;">derby.locks.deadlockTrace</span> to
true. This property is ignored if <span style="font-family: Courier;">derby.locks.monitor</span> is
set to false.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Use <span style="font-family: Courier;">derby.locks.deadlockTrace</span> with care. Setting this property
can alter the timing of the application, severely affect performance, and
produce a very large <span style="font-family: Courier;">derby.log</span> file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For information about working with properties, see the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span>. For information about the
specific properties that are mentioned in this topic, see the
<span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Here is an example of an error message when <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> aborts
a transaction because of a deadlock:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">--SQLException Caught--

SQLState: 40001 =
Error Code: 30000 
Message: A lock could not be obtained due to a deadlock,
cycle of locks and waiters is: Lock : ROW, DEPARTMENT, (1,14)
Waiting XID : {752, X} , APP, update department set location='Boise'
	where deptno='E21'
Granted XID : {758, X} Lock : ROW, EMPLOYEE, (2,8)
Waiting XID : {758, U} , APP, update employee set bonus=150 where salary=23840
Granted XID : {752, X} The selected victim is XID : 752</div></pre><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  You can use the <span style="font-family: Courier;">derby.locks.waitTimeout</span> and
<span style="font-family: Courier;">derby.locks.deadlockTimeout</span> properties
to configure how long <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> waits
for a lock to be released, or when to begin deadlock checking. For more information
about these properties, see the section that discusses controlling <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> application
behavior in the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span>.</div></div></div></div><div><a name="N192A6"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminspace21579"></a><div></div>Reclaiming unused space</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">A <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> table
or index (sometimes called a <span style="font-style: italic;">conglomerate</span>) can contain unused space
after large amounts of data have been deleted or updated.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This happens because, by default, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not return unused space to the operating system. After a page has been allocated
to a table or index, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not automatically return the page to the operating system until the table
or index is dropped, even if the space is no longer needed. However, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
provide a way to reclaim unused space in tables and associated indexes.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you determine that a table and its indexes have a significant amount
of unused space, use either the SYSCS_UTIL.SYSCS_COMPRESS_TABLE or SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE
procedure to reclaim that space. SYSCS_COMPRESS_TABLE is guaranteed to recover
the maximum amount of free space, at the cost of temporarily creating new
tables and indexes before the statement is committed. SYSCS_INPLACE_COMPRESS
attempts to reclaim space within the same table, but cannot guarantee it will
recover all available space. The difference between the two procedures is
that unlike SYSCS_COMPRESS_TABLE, the SYSCS_INPLACE_COMPRESS procedure uses
no temporary files and moves rows around within the same conglomerate.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
You can use the SYSCS_DIAG.SPACE_TABLE diagnostic table to estimate the
amount of unused space in a table or index by examining, in particular, the
values of the NUMFREEPAGES and ESTIMSPACESAVING columns. For example:
</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">
SELECT * FROM TABLE(SYSCS_DIAG.SPACE_TABLE('APP', 'FLIGHTAVAILABILITY')) AS T
</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">
For more information about SYSCS_DIAG.SPACE_TABLE, see "SYSCS_DIAG
diagnostic tables and functions" in the
<span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span></span>.
</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N19315"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">As an example, after you have determined that the FlightAvailability
table and its related indexes have too much unused space, you could reclaim
that space with the following command:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">call SYSCS_UTIL.SYSCS_COMPRESS_TABLE('APP', 'FLIGHTAVAILABILITY', 0);</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> The
third parameter in the SYSCS_UTIL.SYSCS_COMPRESS_TABLE() procedure determines
whether the operation will run in sequential or non-sequential mode. If you
specify <span style="font-family: Courier;">0</span> for the third argument in the procedure, the operation
will run in non-sequential mode. In sequential mode,<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> compresses
the table and indexes sequentially, one at a time. Sequential compression
uses less memory and disk space but is slower. To force the operation to run
in sequential mode, substitute a non-zero SMALLINT value for the third argument.
The following example shows how to force the procedure to run in sequential
mode:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">call SYSCS_UTIL.SYSCS_COMPRESS_TABLE('APP', 'FLIGHTAVAILABILITY', 1);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1933B"></a><span></span>For more information about this command, see the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span></span>.</div></div></div></div><div><a name="N193BB"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="radmintrademderby"></a><div></div>Trademarks</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following terms are trademarks or registered trademarks of other companies
and have been used in at least one of the documents in the <span style="border-right-width: 0pt; border-left-width: 0pt;">Apache Derby</span> documentation
library:</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Cloudscape, DB2, DB2 Universal Database, DRDA, and IBM are trademarks of
International Business Machines Corporation in the United States, other countries,
or both.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Microsoft, Windows, Windows NT, and the Windows logo are trademarks of
Microsoft Corporation in the United States, other countries, or both. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Oracle and Java are registered trademarks of Oracle and/or its affiliates.
Other names may be trademarks of their respective owners.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">UNIX is a registered trademark of The Open Group in the United States and
other countries.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Other company, product, or service names may be trademarks or service marks
of others.</div></div></div></div></div><div valign="top"><div style="font-family: Helvetica; font-weight: bold; font-size: 10pt; text-align: center;"><span>&bull;</span></div></div><br></body></html>